---
title: '简述网页版微信扫码登录的过程' 
date: 2018-12-26 2:30:13
hidden: true
slug: 8xe198seyii
categories: [reprint]
---

{{< raw >}}

                    
<p><a href="http://followtry.cn/2017-09-01/web-weixin-login.html" rel="nofollow noreferrer" target="_blank">我的小站</a></p>
<h2 id="articleHeader0">网页版微信扫码登录流程</h2>
<h3 id="articleHeader1">1. 请求页面</h3>
<p>先打开<a href="https://wx.qq.com/" rel="nofollow noreferrer" target="_blank">https://wx.qq.com/</a>显示出页面，这时候会加载一堆的html，js等资源。</p>
<h3 id="articleHeader2">2. 获取会话UUID</h3>
<p>微信Web版本不使用用户名和密码登录，而是采用扫描二维码登录，所以服务器需要首先分配一个唯一的会话ID，用来标识当前的一次登录。</p>
<p>使用get方法，通过请求地址：<a href="https://login.weixin.qq.com/jslogin?appid=wx782c26e4c19acffb&amp;fun=new&amp;lang=zh_CN&amp;_=%E6%97%B6%E9%97%B4%E6%88%B3" rel="nofollow noreferrer" target="_blank">https://login.weixin.qq.com/j...</a></p>
<p>其中，时间戳这个值是当前距离林威治标准时间的毫秒。</p>
<p>get成功，则返回：window.QRLogin.code = 200; window.QRLogin.uuid = "AAAAAAAA"<br>其中的AAAAAAAA就是我们需要的uuid</p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996730?w=2476&amp;h=670" src="https://static.alili.tech/img/remote/1460000011996730?w=2476&amp;h=670" alt="web端微信登录" title="web端微信登录" style="cursor: pointer; display: inline;"></span></p>
<h3 id="articleHeader3">3. 获取登录二维码</h3>
<p>访问网址：<a href="https://login.weixin.qq.com/qrcode/XXXXXX" rel="nofollow noreferrer" target="_blank">https://login.weixin.qq.com/q...</a><br>这里的XXXXXXX就是我们刚才获取的uuid，这个网址直接显示的就是二维码,该二维码是有有效期的，有效期时长由微信服务端决定。</p>
<h3 id="articleHeader4">4. 查询是否扫描二维码登录</h3>
<p>显示了二维码以后，用户必须用手机微信扫描这个二维码才能登录。（微信为啥要这么设计？很奇怪的思维。。。我用电脑很多情况不就是因为手机没在旁边吗。。。）</p>
<p>使用get方法，查询地址：<a href="https://login.weixin.qq.com/cgi-bin/mmwebwx-bin/login?loginicon=true&amp;uuid=AAAAAAAA&amp;tip=1&amp;r=-921646107&amp;_=%E6%97%B6%E9%97%B4%E6%88%B3" rel="nofollow noreferrer" target="_blank">https://login.weixin.qq.com/c...</a></p>
<p>这里的AAAAAAAA是我们刚才获取的uuid，时间戳同上。tip在第一次获取时应为1，其他次时为0.</p>
<p>如果服务器返回：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="window.code=201，
window.userAvatar = base64:img/bbb" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs gauss"><code><span class="hljs-built_in">window</span>.<span class="hljs-built_in">code</span>=<span class="hljs-number">201</span>，
<span class="hljs-built_in">window</span>.userAvatar = base64:img/bbb</code></pre>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996731?w=2494&amp;h=688" src="https://static.alili.tech/img/remote/1460000011996731?w=2494&amp;h=688" alt="web端微信登录" title="web端微信登录" style="cursor: pointer;"></span></p>
<p>则说明此时用户在手机端已经完成扫描，并在网页端显示扫描人的头像。但还没有点击登录，继续使用上面的地址查询。</p>
<p>点击登录后，如果服务器返回：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="window.code=200;
window.redirect_uri=&quot;https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage?ticket=AZBAkjuOKc-2GAHcRBsKNuOt@qrticket_0&amp;uuid=YbHBoVi8_w==&amp;lang=zh_CN&amp;scan=1504160545&quot;;" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs gauss"><code><span class="hljs-built_in">window</span>.<span class="hljs-built_in">code</span>=<span class="hljs-number">200</span>;
<span class="hljs-built_in">window</span>.redirect_uri=<span class="hljs-string">"https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage?ticket=AZBAkjuOKc-2GAHcRBsKNuOt@qrticket_0&amp;uuid=YbHBoVi8_w==&amp;lang=zh_CN&amp;scan=1504160545"</span>;</code></pre>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996732" src="https://static.alili.tech/img/remote/1460000011996732" alt="web端微信登录" title="web端微信登录" style="cursor: pointer; display: inline;"></span></p>
<p>则说明此时用户在手机端已经确认登录，<code>window.redirect_uri=</code>后面的这个网址（暂称为BB）要记下来，接着要访问这个地址。</p>
<p>如果服务器返回：window.code=408，则说明等待超时，继续使用上面的地址查询。</p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996733?w=2018&amp;h=610" src="https://static.alili.tech/img/remote/1460000011996733?w=2018&amp;h=610" alt="web端微信登录" title="web端微信登录" style="cursor: pointer; display: inline;"></span></p>
<h3 id="articleHeader5">5. 访问登录地址BB，获得uin、sid、pass_ticket、skey</h3>
<p>用get方法，访问在上一步骤获得访问地址BB，并在参数后面加上：&amp;fun=new，会返回一个xml格式的文本，类似这样：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="    <error>
    <ret>0</ret>
    <message></message>
    <skey>@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba</skey>
    <wxsid>n/5yTn844+kHkU66</wxsid>
    <wxuin>2799942121</wxuin>
    <pass_ticket>JOkd35AoEoi8MVx34qKT6xJVeaS8tT7mo8BFdGlKRfDGRCWKkKLW9DsrA%2BEJ34WM</pass_ticket>
    <isgrayscale>1</isgrayscale>
    </error>" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="xml hljs"><code class="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">error</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ret</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">ret</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">message</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">message</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">skey</span>&gt;</span>@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba<span class="hljs-tag">&lt;/<span class="hljs-name">skey</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">wxsid</span>&gt;</span>n/5yTn844+kHkU66<span class="hljs-tag">&lt;/<span class="hljs-name">wxsid</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">wxuin</span>&gt;</span>2799942121<span class="hljs-tag">&lt;/<span class="hljs-name">wxuin</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">pass_ticket</span>&gt;</span>JOkd35AoEoi8MVx34qKT6xJVeaS8tT7mo8BFdGlKRfDGRCWKkKLW9DsrA%2BEJ34WM<span class="hljs-tag">&lt;/<span class="hljs-name">pass_ticket</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">isgrayscale</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">isgrayscale</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">error</span>&gt;</span></code></pre>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996734?w=2878&amp;h=536" src="https://static.alili.tech/img/remote/1460000011996734?w=2878&amp;h=536" alt="web端微信登录" title="web端微信登录" style="cursor: pointer;"></span></p>
<ul>
<li><p>skey是获取联系人信息的关键信息(比如获取好友（包括订阅的公众号）头像信息），标识当前人的身份。还是检查web端微信心跳的标识。发消息时也会使用。</p></li>
<li><p>pass_ticket是在授权成功后进行初始化和收发消息使用的。</p></li>
<li><p>wxsid在收发消息会子啊url后或请求体中使用。</p></li>
<li><p>wxuin在发消息时使用</p></li>
</ul>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996735?w=1884&amp;h=914" src="https://static.alili.tech/img/remote/1460000011996735?w=1884&amp;h=914" alt="web端微信登录" title="web端微信登录" style="cursor: pointer;"></span></p>
<p>把这里的wxuin，wxsid，skey，pass_ticket都记下来，这是重要数据。</p>
<p>该结果中包含的信息就是用来在接下来的请求中校验用户用的。</p>
<p><strong>到这里已经表明当前用户已经扫码登录成功了，而且可以看到只是通过ticket方式确认web端登录成功，而不经过用户名密码方式的登录，其实个人感觉就是移动端微信扫码给web端发送了一个授权而已。</strong></p>
<h3 id="articleHeader6">6. 微信初始化</h3>
<p>这个是很重要的一步，我在这个步骤折腾了很久。。。</p>
<p>要使用POST方法，访问地址：<code>https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxinit?r=-918790895&amp;pass_ticket=JOkd35AoEoi8MVx34qKT6xJVeaS8tT7mo8BFdGlKRfDGRCWKkKLW9DsrA%252BEJ34WM</code></p>
<p>其中，时间戳不用解释，pass_ticket是我们在上面获取的一长串字符。</p>
<p>POST的内容是个json串，{"BaseRequest":{"Uin":"XXXXXXXX","Sid":"XXXXXXXX","Skey":XXXXXXXXXXXXX","DeviceID":"e123456789012345""}}"</p>
<p>uin、sid、skey分别对应上面步骤4获取的字符串，DeviceID是e后面跟着一个15字节的随机数。</p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996736?w=2878&amp;h=842" src="https://static.alili.tech/img/remote/1460000011996736?w=2878&amp;h=842" alt="web端微信登录" title="web端微信登录" style="cursor: pointer;"></span></p>
<p>程序里面要注意使用UTF8编码方式。<br>POST成功，则服务器返回一个很长的JSON串，格式是这样：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="{
    &quot;BaseResponse&quot;:{
        &quot;Ret&quot;:0,
        &quot;ErrMsg&quot;:&quot;&quot;
    },
    &quot;Count&quot;:11,
    &quot;ContactList&quot;:[
        {//公众号或文件助手信息
            &quot;Uin&quot;:0,
            &quot;UserName&quot;:&quot;filehelper&quot;,
            &quot;NickName&quot;:&quot;æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹&quot;,
            &quot;HeadImgUrl&quot;:&quot;/cgi-bin/mmwebwx-bin/webwxgeticon?seq=660589401&amp;username=filehelper&amp;skey=@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba&quot;,
            &quot;ContactFlag&quot;:1,
            &quot;MemberCount&quot;:0,
            &quot;MemberList&quot;:[],
            &quot;RemarkName&quot;:&quot;&quot;,
            &quot;HideInputBarFlag&quot;:0,
            &quot;Sex&quot;:0,
            &quot;Signature&quot;:&quot;&quot;,
            &quot;VerifyFlag&quot;:0,
            &quot;OwnerUin&quot;:0,
            &quot;PYInitial&quot;:&quot;WJCSZS&quot;,
            &quot;PYQuanPin&quot;:&quot;wenjianchuanshuzhushou&quot;,
            &quot;RemarkPYInitial&quot;:&quot;&quot;,
            &quot;RemarkPYQuanPin&quot;:&quot;&quot;,
            &quot;StarFriend&quot;:0,
            &quot;AppAccountFlag&quot;:0,
            &quot;Statues&quot;:0,
            &quot;AttrStatus&quot;:0,
            &quot;Province&quot;:&quot;&quot;,
            &quot;City&quot;:&quot;&quot;,
            &quot;Alias&quot;:&quot;&quot;,
            &quot;SnsFlag&quot;:0,
            &quot;UniFriend&quot;:0,
            &quot;DisplayName&quot;:&quot;&quot;,
            &quot;ChatRoomId&quot;:0,
            &quot;KeyWord&quot;:&quot;fil&quot;,
            &quot;EncryChatRoomId&quot;:&quot;&quot;,
            &quot;IsOwner&quot;:0
        },
        {
            &quot;Uin&quot;:0,
            &quot;UserName&quot;:&quot;@@ed82e31e61783c765723eb8574831ae0be272bbb6b02f7280e442b0d274e8cb9&quot;,
            &quot;NickName&quot;:&quot;è¯—é…’è¶å¹´åŽ&quot;,
            &quot;HeadImgUrl&quot;:&quot;/cgi-bin/mmwebwx-bin/webwxgetheadimg?seq=660624044&amp;username=@@ed82e31e61783c765723eb8574831ae0be272bbb6b02f7280e442b0d274e8cb9&amp;skey=@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba&quot;,
            &quot;ContactFlag&quot;:2051,
            &quot;MemberCount&quot;:13,
            &quot;MemberList&quot;:[//用户信息
                {
                    &quot;Uin&quot;:0,
                    &quot;UserName&quot;:&quot;@4dae6aa0756bd9899b68d0b2e60f109d&quot;,
                    &quot;NickName&quot;:&quot;&quot;,
                    &quot;AttrStatus&quot;:0,
                    &quot;PYInitial&quot;:&quot;&quot;,
                    &quot;PYQuanPin&quot;:&quot;&quot;,
                    &quot;RemarkPYInitial&quot;:&quot;&quot;,
                    &quot;RemarkPYQuanPin&quot;:&quot;&quot;,
                    &quot;MemberStatus&quot;:0,
                    &quot;DisplayName&quot;:&quot;&quot;,
                    &quot;KeyWord&quot;:&quot;cha&quot;
                }
            ],
            &quot;RemarkName&quot;:&quot;&quot;,
            &quot;HideInputBarFlag&quot;:0,
            &quot;Sex&quot;:0,
            &quot;Signature&quot;:&quot;&quot;,
            &quot;VerifyFlag&quot;:0,
            &quot;OwnerUin&quot;:0,
            &quot;PYInitial&quot;:&quot;&quot;,
            &quot;PYQuanPin&quot;:&quot;&quot;,
            &quot;RemarkPYInitial&quot;:&quot;&quot;,
            &quot;RemarkPYQuanPin&quot;:&quot;&quot;,
            &quot;StarFriend&quot;:0,
            &quot;AppAccountFlag&quot;:0,
            &quot;Statues&quot;:1,
            &quot;AttrStatus&quot;:0,
            &quot;Province&quot;:&quot;&quot;,
            &quot;City&quot;:&quot;&quot;,
            &quot;Alias&quot;:&quot;&quot;,
            &quot;SnsFlag&quot;:0,
            &quot;UniFriend&quot;:0,
            &quot;DisplayName&quot;:&quot;&quot;,
            &quot;ChatRoomId&quot;:0,
            &quot;KeyWord&quot;:&quot;&quot;,
            &quot;EncryChatRoomId&quot;:&quot;&quot;,
            &quot;IsOwner&quot;:0
        }
    ],
    &quot;SyncKey&quot;:{
        &quot;Count&quot;:4,
        &quot;List&quot;:[
            {
                &quot;Key&quot;:1,
                &quot;Val&quot;:660633313
            },
            {
                &quot;Key&quot;:2,
                &quot;Val&quot;:660633314
            },
            {
                &quot;Key&quot;:3,
                &quot;Val&quot;:660633176
            },
            {
                &quot;Key&quot;:1000,
                &quot;Val&quot;:1504141382
            }
        ]
    },
    &quot;User&quot;:{//当前用户信息
        &quot;Uin&quot;:2799942121,
        &quot;UserName&quot;:&quot;@cee283ef70f5473680a467d23da14918888aa5771f1b08c7410b2ca3d685dd6a&quot;,
        &quot;NickName&quot;:&quot;followtry&quot;,
        &quot;HeadImgUrl&quot;:&quot;/cgi-bin/mmwebwx-bin/webwxgeticon?seq=842975299&amp;username=@cee283ef70f5473680a467d23da14918888aa5771f1b08c7410b2ca3d685dd6a&amp;skey=@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba&quot;,
        &quot;RemarkName&quot;:&quot;&quot;,
        &quot;PYInitial&quot;:&quot;&quot;,
        &quot;PYQuanPin&quot;:&quot;&quot;,
        &quot;RemarkPYInitial&quot;:&quot;&quot;,
        &quot;RemarkPYQuanPin&quot;:&quot;&quot;,
        &quot;HideInputBarFlag&quot;:0,
        &quot;StarFriend&quot;:0,
        &quot;Sex&quot;:1,
        &quot;Signature&quot;:&quot;&quot;,
        &quot;AppAccountFlag&quot;:0,
        &quot;VerifyFlag&quot;:0,
        &quot;ContactFlag&quot;:0,
        &quot;WebWxPluginSwitch&quot;:0,
        &quot;HeadImgFlag&quot;:1,
        &quot;SnsFlag&quot;:17
    },
    &quot;ChatSet&quot;:&quot;filehelper,weixin,@@ed82e31e61783c765723eb8574831ae0be272bbb6b02f7280e442b0d274e8cb9,&quot;,
    &quot;SKey&quot;:&quot;@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba&quot;,//我的skey，也就是个人标识
    &quot;ClientVersion&quot;:637865269,
    &quot;SystemTime&quot;:1504157627,
    &quot;GrayScale&quot;:1,
    &quot;InviteStartCount&quot;:40,
    &quot;MPSubscribeMsgCount&quot;:22,
    &quot;MPSubscribeMsgList&quot;:[//订阅信息列表
        {
            &quot;UserName&quot;:&quot;@d532ab26f3404fdc3a95bc7a7d3ae368&quot;,
            &quot;MPArticleCount&quot;:4,//拉取四篇文章
            &quot;MPArticleList&quot;:[//文章列表信息
                {
                    &quot;Title&quot;:&quot;Ubuntu Linux&quot;,
                    &quot;Cover&quot;:&quot;http://mmbiz.qpic.cn/mmbiz_jpg/W9DqKgFsc6icYW9UsESlGZ2r3SEOjIwqeToauxczCXYPLW63YtYmCcK2mxTaRjH7XibemZZOcVXknLFsPnhSLyeg/640?wxtype=jpeg&amp;wxfrom=0&quot;,
                    &quot;Url&quot;:&quot;http://mp.weixin.qq.com/s?__biz=MjM5NjQ4MjYwMQ==&amp;mid=2664609333&amp;idx=1&amp;sn=9eec4c182757edc5d2e98b2dfa5752b1&amp;chksm=bdce8d738ab904653e64f18e23a8ffe8634fc1547edc05e2dad547de69894d5df572cc4f2b12&amp;scene=0#rd&quot;
                }
            ],
            &quot;Time&quot;:1504153992,
            &quot;NickName&quot;:&quot;Linuxä¸­å›½&quot;
        }
    ],
    &quot;ClickReportInterval&quot;:600000
}" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="json hljs"><code class="json">{
    <span class="hljs-attr">"BaseResponse"</span>:{
        <span class="hljs-attr">"Ret"</span>:<span class="hljs-number">0</span>,
        <span class="hljs-attr">"ErrMsg"</span>:<span class="hljs-string">""</span>
    },
    <span class="hljs-attr">"Count"</span>:<span class="hljs-number">11</span>,
    <span class="hljs-attr">"ContactList"</span>:[
        {//公众号或文件助手信息
            <span class="hljs-attr">"Uin"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"UserName"</span>:<span class="hljs-string">"filehelper"</span>,
            <span class="hljs-attr">"NickName"</span>:<span class="hljs-string">"æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹"</span>,
            <span class="hljs-attr">"HeadImgUrl"</span>:<span class="hljs-string">"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=660589401&amp;username=filehelper&amp;skey=@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba"</span>,
            <span class="hljs-attr">"ContactFlag"</span>:<span class="hljs-number">1</span>,
            <span class="hljs-attr">"MemberCount"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"MemberList"</span>:[],
            <span class="hljs-attr">"RemarkName"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"HideInputBarFlag"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"Sex"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"Signature"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"VerifyFlag"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"OwnerUin"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"PYInitial"</span>:<span class="hljs-string">"WJCSZS"</span>,
            <span class="hljs-attr">"PYQuanPin"</span>:<span class="hljs-string">"wenjianchuanshuzhushou"</span>,
            <span class="hljs-attr">"RemarkPYInitial"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"RemarkPYQuanPin"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"StarFriend"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"AppAccountFlag"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"Statues"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"AttrStatus"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"Province"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"City"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"Alias"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"SnsFlag"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"UniFriend"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"DisplayName"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"ChatRoomId"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"KeyWord"</span>:<span class="hljs-string">"fil"</span>,
            <span class="hljs-attr">"EncryChatRoomId"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"IsOwner"</span>:<span class="hljs-number">0</span>
        },
        {
            <span class="hljs-attr">"Uin"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"UserName"</span>:<span class="hljs-string">"@@ed82e31e61783c765723eb8574831ae0be272bbb6b02f7280e442b0d274e8cb9"</span>,
            <span class="hljs-attr">"NickName"</span>:<span class="hljs-string">"è¯—é…’è¶å¹´åŽ"</span>,
            <span class="hljs-attr">"HeadImgUrl"</span>:<span class="hljs-string">"/cgi-bin/mmwebwx-bin/webwxgetheadimg?seq=660624044&amp;username=@@ed82e31e61783c765723eb8574831ae0be272bbb6b02f7280e442b0d274e8cb9&amp;skey=@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba"</span>,
            <span class="hljs-attr">"ContactFlag"</span>:<span class="hljs-number">2051</span>,
            <span class="hljs-attr">"MemberCount"</span>:<span class="hljs-number">13</span>,
            <span class="hljs-attr">"MemberList"</span>:[//用户信息
                {
                    <span class="hljs-attr">"Uin"</span>:<span class="hljs-number">0</span>,
                    <span class="hljs-attr">"UserName"</span>:<span class="hljs-string">"@4dae6aa0756bd9899b68d0b2e60f109d"</span>,
                    <span class="hljs-attr">"NickName"</span>:<span class="hljs-string">""</span>,
                    <span class="hljs-attr">"AttrStatus"</span>:<span class="hljs-number">0</span>,
                    <span class="hljs-attr">"PYInitial"</span>:<span class="hljs-string">""</span>,
                    <span class="hljs-attr">"PYQuanPin"</span>:<span class="hljs-string">""</span>,
                    <span class="hljs-attr">"RemarkPYInitial"</span>:<span class="hljs-string">""</span>,
                    <span class="hljs-attr">"RemarkPYQuanPin"</span>:<span class="hljs-string">""</span>,
                    <span class="hljs-attr">"MemberStatus"</span>:<span class="hljs-number">0</span>,
                    <span class="hljs-attr">"DisplayName"</span>:<span class="hljs-string">""</span>,
                    <span class="hljs-attr">"KeyWord"</span>:<span class="hljs-string">"cha"</span>
                }
            ],
            <span class="hljs-attr">"RemarkName"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"HideInputBarFlag"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"Sex"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"Signature"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"VerifyFlag"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"OwnerUin"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"PYInitial"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"PYQuanPin"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"RemarkPYInitial"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"RemarkPYQuanPin"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"StarFriend"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"AppAccountFlag"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"Statues"</span>:<span class="hljs-number">1</span>,
            <span class="hljs-attr">"AttrStatus"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"Province"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"City"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"Alias"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"SnsFlag"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"UniFriend"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"DisplayName"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"ChatRoomId"</span>:<span class="hljs-number">0</span>,
            <span class="hljs-attr">"KeyWord"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"EncryChatRoomId"</span>:<span class="hljs-string">""</span>,
            <span class="hljs-attr">"IsOwner"</span>:<span class="hljs-number">0</span>
        }
    ],
    <span class="hljs-attr">"SyncKey"</span>:{
        <span class="hljs-attr">"Count"</span>:<span class="hljs-number">4</span>,
        <span class="hljs-attr">"List"</span>:[
            {
                <span class="hljs-attr">"Key"</span>:<span class="hljs-number">1</span>,
                <span class="hljs-attr">"Val"</span>:<span class="hljs-number">660633313</span>
            },
            {
                <span class="hljs-attr">"Key"</span>:<span class="hljs-number">2</span>,
                <span class="hljs-attr">"Val"</span>:<span class="hljs-number">660633314</span>
            },
            {
                <span class="hljs-attr">"Key"</span>:<span class="hljs-number">3</span>,
                <span class="hljs-attr">"Val"</span>:<span class="hljs-number">660633176</span>
            },
            {
                <span class="hljs-attr">"Key"</span>:<span class="hljs-number">1000</span>,
                <span class="hljs-attr">"Val"</span>:<span class="hljs-number">1504141382</span>
            }
        ]
    },
    <span class="hljs-attr">"User"</span>:{//当前用户信息
        <span class="hljs-attr">"Uin"</span>:<span class="hljs-number">2799942121</span>,
        <span class="hljs-attr">"UserName"</span>:<span class="hljs-string">"@cee283ef70f5473680a467d23da14918888aa5771f1b08c7410b2ca3d685dd6a"</span>,
        <span class="hljs-attr">"NickName"</span>:<span class="hljs-string">"followtry"</span>,
        <span class="hljs-attr">"HeadImgUrl"</span>:<span class="hljs-string">"/cgi-bin/mmwebwx-bin/webwxgeticon?seq=842975299&amp;username=@cee283ef70f5473680a467d23da14918888aa5771f1b08c7410b2ca3d685dd6a&amp;skey=@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba"</span>,
        <span class="hljs-attr">"RemarkName"</span>:<span class="hljs-string">""</span>,
        <span class="hljs-attr">"PYInitial"</span>:<span class="hljs-string">""</span>,
        <span class="hljs-attr">"PYQuanPin"</span>:<span class="hljs-string">""</span>,
        <span class="hljs-attr">"RemarkPYInitial"</span>:<span class="hljs-string">""</span>,
        <span class="hljs-attr">"RemarkPYQuanPin"</span>:<span class="hljs-string">""</span>,
        <span class="hljs-attr">"HideInputBarFlag"</span>:<span class="hljs-number">0</span>,
        <span class="hljs-attr">"StarFriend"</span>:<span class="hljs-number">0</span>,
        <span class="hljs-attr">"Sex"</span>:<span class="hljs-number">1</span>,
        <span class="hljs-attr">"Signature"</span>:<span class="hljs-string">""</span>,
        <span class="hljs-attr">"AppAccountFlag"</span>:<span class="hljs-number">0</span>,
        <span class="hljs-attr">"VerifyFlag"</span>:<span class="hljs-number">0</span>,
        <span class="hljs-attr">"ContactFlag"</span>:<span class="hljs-number">0</span>,
        <span class="hljs-attr">"WebWxPluginSwitch"</span>:<span class="hljs-number">0</span>,
        <span class="hljs-attr">"HeadImgFlag"</span>:<span class="hljs-number">1</span>,
        <span class="hljs-attr">"SnsFlag"</span>:<span class="hljs-number">17</span>
    },
    <span class="hljs-attr">"ChatSet"</span>:<span class="hljs-string">"filehelper,weixin,@@ed82e31e61783c765723eb8574831ae0be272bbb6b02f7280e442b0d274e8cb9,"</span>,
    <span class="hljs-attr">"SKey"</span>:<span class="hljs-string">"@crypt_d6549c5a_37242e82c0913b75e5d3ad5ef2c7bdba"</span>,//我的skey，也就是个人标识
    <span class="hljs-attr">"ClientVersion"</span>:<span class="hljs-number">637865269</span>,
    <span class="hljs-attr">"SystemTime"</span>:<span class="hljs-number">1504157627</span>,
    <span class="hljs-attr">"GrayScale"</span>:<span class="hljs-number">1</span>,
    <span class="hljs-attr">"InviteStartCount"</span>:<span class="hljs-number">40</span>,
    <span class="hljs-attr">"MPSubscribeMsgCount"</span>:<span class="hljs-number">22</span>,
    <span class="hljs-attr">"MPSubscribeMsgList"</span>:[//订阅信息列表
        {
            <span class="hljs-attr">"UserName"</span>:<span class="hljs-string">"@d532ab26f3404fdc3a95bc7a7d3ae368"</span>,
            <span class="hljs-attr">"MPArticleCount"</span>:<span class="hljs-number">4</span>,//拉取四篇文章
            <span class="hljs-attr">"MPArticleList"</span>:[//文章列表信息
                {
                    <span class="hljs-attr">"Title"</span>:<span class="hljs-string">"Ubuntu Linux"</span>,
                    <span class="hljs-attr">"Cover"</span>:<span class="hljs-string">"http://mmbiz.qpic.cn/mmbiz_jpg/W9DqKgFsc6icYW9UsESlGZ2r3SEOjIwqeToauxczCXYPLW63YtYmCcK2mxTaRjH7XibemZZOcVXknLFsPnhSLyeg/640?wxtype=jpeg&amp;wxfrom=0"</span>,
                    <span class="hljs-attr">"Url"</span>:<span class="hljs-string">"http://mp.weixin.qq.com/s?__biz=MjM5NjQ4MjYwMQ==&amp;mid=2664609333&amp;idx=1&amp;sn=9eec4c182757edc5d2e98b2dfa5752b1&amp;chksm=bdce8d738ab904653e64f18e23a8ffe8634fc1547edc05e2dad547de69894d5df572cc4f2b12&amp;scene=0#rd"</span>
                }
            ],
            <span class="hljs-attr">"Time"</span>:<span class="hljs-number">1504153992</span>,
            <span class="hljs-attr">"NickName"</span>:<span class="hljs-string">"Linuxä¸­å›½"</span>
        }
    ],
    <span class="hljs-attr">"ClickReportInterval"</span>:<span class="hljs-number">600000</span>
}</code></pre>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996737?w=2878&amp;h=388" src="https://static.alili.tech/img/remote/1460000011996737?w=2878&amp;h=388" alt="web端微信登录" title="web端微信登录" style="cursor: pointer; display: inline;"></span></p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996738?w=2872&amp;h=418" src="https://static.alili.tech/img/remote/1460000011996738?w=2872&amp;h=418" alt="web端微信登录" title="web端微信登录" style="cursor: pointer; display: inline;"></span></p>
<p>拿到该结果后，浏览器会渲染最近联系人，各个订阅的公众号的最近几篇文章。</p>
<h3 id="articleHeader7">7. 获取好友列表</h3>
<p>使用POST方法，访问：<a href="https://wx2.qq.com/cgi-bin/mmwebwx-bin/webwxgetcontact?r=%E6%97%B6%E9%97%B4%E6%88%B3" rel="nofollow noreferrer" target="_blank">https://wx2.qq.com/cgi-bin/mm...</a></p>
<p>POST的内容为空。成功则以JSON格式返回所有联系人的信息。格式类似：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="{
    &quot;BaseResponse&quot;: {
        &quot;Ret&quot;: 0,
        &quot;ErrMsg&quot;: &quot;&quot;
    },
    &quot;MemberCount&quot;: 21,
    &quot;MemberList&quot;: [
        {
            &quot;Uin&quot;: 0,
            &quot;UserName&quot;: xxx,
            &quot;NickName&quot;: &quot;Urinx&quot;,
            &quot;HeadImgUrl&quot;: xxx,
            &quot;ContactFlag&quot;: 3,
            &quot;MemberCount&quot;: 0,
            &quot;MemberList&quot;: [],
            &quot;RemarkName&quot;: &quot;&quot;,
            &quot;HideInputBarFlag&quot;: 0,
            &quot;Sex&quot;: 0,
            &quot;Signature&quot;: &quot;xxxx&quot;,
            &quot;VerifyFlag&quot;: 8,
            &quot;OwnerUin&quot;: 0,
            &quot;PYInitial&quot;: &quot;URINX&quot;,
            &quot;PYQuanPin&quot;: &quot;Urinx&quot;,
            &quot;RemarkPYInitial&quot;: &quot;&quot;,
            &quot;RemarkPYQuanPin&quot;: &quot;&quot;,
            &quot;StarFriend&quot;: 0,
            &quot;AppAccountFlag&quot;: 0,
            &quot;Statues&quot;: 0,
            &quot;AttrStatus&quot;: 0,
            &quot;Province&quot;: &quot;&quot;,
            &quot;City&quot;: &quot;&quot;,
            &quot;Alias&quot;: &quot;Urinxs&quot;,
            &quot;SnsFlag&quot;: 0,
            &quot;UniFriend&quot;: 0,
            &quot;DisplayName&quot;: &quot;&quot;,
            &quot;ChatRoomId&quot;: 0,
            &quot;KeyWord&quot;: &quot;gh_&quot;,
            &quot;EncryChatRoomId&quot;: &quot;&quot;
        },
        ...
    ],
    &quot;Seq&quot;: 0
}
其中，MemberCount表示总共有多少联系人，里面的内容都比较清晰。" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="json hljs"><code class="json">{
    <span class="hljs-attr">"BaseResponse"</span>: {
        <span class="hljs-attr">"Ret"</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">"ErrMsg"</span>: <span class="hljs-string">""</span>
    },
    <span class="hljs-attr">"MemberCount"</span>: <span class="hljs-number">21</span>,
    <span class="hljs-attr">"MemberList"</span>: [
        {
            <span class="hljs-attr">"Uin"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"UserName"</span>: xxx,
            <span class="hljs-attr">"NickName"</span>: <span class="hljs-string">"Urinx"</span>,
            <span class="hljs-attr">"HeadImgUrl"</span>: xxx,
            <span class="hljs-attr">"ContactFlag"</span>: <span class="hljs-number">3</span>,
            <span class="hljs-attr">"MemberCount"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"MemberList"</span>: [],
            <span class="hljs-attr">"RemarkName"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"HideInputBarFlag"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"Sex"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"Signature"</span>: <span class="hljs-string">"xxxx"</span>,
            <span class="hljs-attr">"VerifyFlag"</span>: <span class="hljs-number">8</span>,
            <span class="hljs-attr">"OwnerUin"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"PYInitial"</span>: <span class="hljs-string">"URINX"</span>,
            <span class="hljs-attr">"PYQuanPin"</span>: <span class="hljs-string">"Urinx"</span>,
            <span class="hljs-attr">"RemarkPYInitial"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"RemarkPYQuanPin"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"StarFriend"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"AppAccountFlag"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"Statues"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"AttrStatus"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"Province"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"City"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"Alias"</span>: <span class="hljs-string">"Urinxs"</span>,
            <span class="hljs-attr">"SnsFlag"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"UniFriend"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"DisplayName"</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">"ChatRoomId"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">"KeyWord"</span>: <span class="hljs-string">"gh_"</span>,
            <span class="hljs-attr">"EncryChatRoomId"</span>: <span class="hljs-string">""</span>
        },
        ...
    ],
    <span class="hljs-attr">"Seq"</span>: <span class="hljs-number">0</span>
}
其中，MemberCount表示总共有多少联系人，里面的内容都比较清晰。</code></pre>
<h3 id="articleHeader8">8. 开启微信状态通知</h3>
<p>用POST方法，访问：<a href="https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxstatusnotify" rel="nofollow noreferrer" target="_blank">https://wx.qq.com/cgi-bin/mmw...</a></p>
<p>POST的内容是JSON串，格式：</p>
<p>{</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text=" BaseRequest: { Uin: xxx, Sid: xxx, Skey: xxx, DeviceID: xxx }, 
 Code: 3, 
 FromUserName: 自己ID, 
 ToUserName: 自己ID, 
 ClientMsgId: 时间戳 " title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs less"><code> <span class="hljs-attribute">BaseRequest</span>: { <span class="hljs-attribute">Uin</span>: xxx, <span class="hljs-attribute">Sid</span>: xxx, <span class="hljs-attribute">Skey</span>: xxx, <span class="hljs-attribute">DeviceID</span>: xxx }, 
 <span class="hljs-attribute">Code</span>: <span class="hljs-number">3</span>, 
 <span class="hljs-attribute">FromUserName</span>: 自己ID, 
 <span class="hljs-attribute">ToUserName</span>: 自己ID, 
 <span class="hljs-attribute">ClientMsgId</span>: 时间戳 </code></pre>
<p>}</p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996739?w=2870&amp;h=816" src="https://static.alili.tech/img/remote/1460000011996739?w=2870&amp;h=816" alt="web端微信登录" title="web端微信登录" style="cursor: pointer; display: inline;"></span></p>
<h3 id="articleHeader9">9. 心跳包，与服务器同步并获取状态</h3>
<p>以上步骤完成以后，就可以进入收发微信的循环了，可以用线程方式发送心跳包。</p>
<p>使用get方法，设置超时为60秒，访问：<a href="https://webpush.wx2.qq.com/cgi-bin/mmwebwx-bin/synccheck?sid=XXXXXX&amp;uin=XXXXXX&amp;synckey=XXXXXX&amp;r=%E6%97%B6%E9%97%B4%E6%88%B3&amp;skey=XXXXXX&amp;deviceid=XXXXXX&amp;_=%E6%97%B6%E9%97%B4%E6%88%B3" rel="nofollow noreferrer" target="_blank">https://webpush.wx2.qq.com/cg...</a></p>
<p>其他几个参数不用解释，这里的synckey需要说一下，前面的步骤获取的json串中有多个key信息，需要把这些信息拼起来，key_val，中间用|分割，类似这样：</p>
<p>1_652651920|2_652651939|3_652651904|1000_0<br>服务器返回：window.synccheck={retcode:”0”,selector:”0”}</p>
<p>retcode为0表示成功，selector为2和6表示有新信息。4表示公众号新信息。</p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996740?w=2412&amp;h=656" src="https://static.alili.tech/img/remote/1460000011996740?w=2412&amp;h=656" alt="web端微信登录" title="web端微信登录" style="cursor: pointer;"></span></p>
<h3 id="articleHeader10">10. 接收新信息</h3>
<p>检测到有新的消息以后，用POST方法，访问：<a href="https://wx2.qq.com/cgi-bin/mmwebwx-bin/webwxsync?sid=XXXXXX&amp;skey=XXXXXX" rel="nofollow noreferrer" target="_blank">https://wx2.qq.com/cgi-bin/mm...</a></p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996741?w=2636&amp;h=714" src="https://static.alili.tech/img/remote/1460000011996741?w=2636&amp;h=714" alt="web端微信登录" title="web端微信登录" style="cursor: pointer;"></span></p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996742?w=2878&amp;h=584" src="https://static.alili.tech/img/remote/1460000011996742?w=2878&amp;h=584" alt="web端微信登录" title="web端微信登录" style="cursor: pointer;"></span></p>
<p>POST的内容：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="{
   &quot;BaseResponse&quot;:{
       &quot;Ret&quot;:0,
       &quot;ErrMsg&quot;:&quot;&quot;
   },
   &quot;AddMsgCount&quot;:0,
   &quot;AddMsgList&quot;:[

   ],
   &quot;ModContactCount&quot;:0,
   &quot;ModContactList&quot;:[

   ],
   &quot;DelContactCount&quot;:0,
   &quot;DelContactList&quot;:[

   ],
   &quot;ModChatRoomMemberCount&quot;:0,
   &quot;ModChatRoomMemberList&quot;:[

   ],
   &quot;Profile&quot;:{
       &quot;BitFlag&quot;:0,
       &quot;UserName&quot;:{
           &quot;Buff&quot;:&quot;&quot;
       },
       &quot;NickName&quot;:{
           &quot;Buff&quot;:&quot;&quot;
       },
       &quot;BindUin&quot;:0,
       &quot;BindEmail&quot;:{
           &quot;Buff&quot;:&quot;&quot;
       },
       &quot;BindMobile&quot;:{
           &quot;Buff&quot;:&quot;&quot;
       },
       &quot;Status&quot;:0,
       &quot;Sex&quot;:0,
       &quot;PersonalCard&quot;:0,
       &quot;Alias&quot;:&quot;&quot;,
       &quot;HeadImgUpdateFlag&quot;:0,
       &quot;HeadImgUrl&quot;:&quot;&quot;,
       &quot;Signature&quot;:&quot;&quot;
   },
   &quot;ContinueFlag&quot;:0,
   &quot;SyncKey&quot;:{
       &quot;Count&quot;:7,
       &quot;List&quot;:[
           {
               &quot;Key&quot;:1,
               &quot;Val&quot;:660633324
           }
       ]
   },
   &quot;SKey&quot;:&quot;&quot;,
   &quot;SyncCheckKey&quot;:{
       &quot;Count&quot;:7,
       &quot;List&quot;:[
           {
               &quot;Key&quot;:1,
               &quot;Val&quot;:660633324
           }
       ]
   }
}" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="json hljs"><code class="json">{
   <span class="hljs-attr">"BaseResponse"</span>:{
       <span class="hljs-attr">"Ret"</span>:<span class="hljs-number">0</span>,
       <span class="hljs-attr">"ErrMsg"</span>:<span class="hljs-string">""</span>
   },
   <span class="hljs-attr">"AddMsgCount"</span>:<span class="hljs-number">0</span>,
   <span class="hljs-attr">"AddMsgList"</span>:[

   ],
   <span class="hljs-attr">"ModContactCount"</span>:<span class="hljs-number">0</span>,
   <span class="hljs-attr">"ModContactList"</span>:[

   ],
   <span class="hljs-attr">"DelContactCount"</span>:<span class="hljs-number">0</span>,
   <span class="hljs-attr">"DelContactList"</span>:[

   ],
   <span class="hljs-attr">"ModChatRoomMemberCount"</span>:<span class="hljs-number">0</span>,
   <span class="hljs-attr">"ModChatRoomMemberList"</span>:[

   ],
   <span class="hljs-attr">"Profile"</span>:{
       <span class="hljs-attr">"BitFlag"</span>:<span class="hljs-number">0</span>,
       <span class="hljs-attr">"UserName"</span>:{
           <span class="hljs-attr">"Buff"</span>:<span class="hljs-string">""</span>
       },
       <span class="hljs-attr">"NickName"</span>:{
           <span class="hljs-attr">"Buff"</span>:<span class="hljs-string">""</span>
       },
       <span class="hljs-attr">"BindUin"</span>:<span class="hljs-number">0</span>,
       <span class="hljs-attr">"BindEmail"</span>:{
           <span class="hljs-attr">"Buff"</span>:<span class="hljs-string">""</span>
       },
       <span class="hljs-attr">"BindMobile"</span>:{
           <span class="hljs-attr">"Buff"</span>:<span class="hljs-string">""</span>
       },
       <span class="hljs-attr">"Status"</span>:<span class="hljs-number">0</span>,
       <span class="hljs-attr">"Sex"</span>:<span class="hljs-number">0</span>,
       <span class="hljs-attr">"PersonalCard"</span>:<span class="hljs-number">0</span>,
       <span class="hljs-attr">"Alias"</span>:<span class="hljs-string">""</span>,
       <span class="hljs-attr">"HeadImgUpdateFlag"</span>:<span class="hljs-number">0</span>,
       <span class="hljs-attr">"HeadImgUrl"</span>:<span class="hljs-string">""</span>,
       <span class="hljs-attr">"Signature"</span>:<span class="hljs-string">""</span>
   },
   <span class="hljs-attr">"ContinueFlag"</span>:<span class="hljs-number">0</span>,
   <span class="hljs-attr">"SyncKey"</span>:{
       <span class="hljs-attr">"Count"</span>:<span class="hljs-number">7</span>,
       <span class="hljs-attr">"List"</span>:[
           {
               <span class="hljs-attr">"Key"</span>:<span class="hljs-number">1</span>,
               <span class="hljs-attr">"Val"</span>:<span class="hljs-number">660633324</span>
           }
       ]
   },
   <span class="hljs-attr">"SKey"</span>:<span class="hljs-string">""</span>,
   <span class="hljs-attr">"SyncCheckKey"</span>:{
       <span class="hljs-attr">"Count"</span>:<span class="hljs-number">7</span>,
       <span class="hljs-attr">"List"</span>:[
           {
               <span class="hljs-attr">"Key"</span>:<span class="hljs-number">1</span>,
               <span class="hljs-attr">"Val"</span>:<span class="hljs-number">660633324</span>
           }
       ]
   }
}</code></pre>
<p>注意这里的SyncKey格式，参考前面的说明。</p>
<p>请求成功之后服务器会返回一个JSON串，其中AddMsgCount表示有多少信息，AddMsgList中是一个数组，包含了所有新消息，里面的MsgType表示信息类型，Content就是信息内容。<br>注意again，返回的信息中，会有新的synckey，要更新这个内容，下次获取信息访问要用这个新的key。</p>
<h3 id="articleHeader11">11. 发送信息</h3>
<p>这个比较简单，用POST方法，访问：<a href="https://wx2.qq.com/cgi-bin/mmwebwx-bin/webwxsendmsg" rel="nofollow noreferrer" target="_blank">https://wx2.qq.com/cgi-bin/mm...</a></p>
<p>POST的还是json格式，类似这样：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="{
   &quot;Msg&quot;:{
       &quot;Type&quot;:1,
       &quot;Content&quot;:&quot;测试信息&quot;,
       &quot;FromUserName&quot;:&quot;XXXXXX&quot;,
       &quot;ToUserName&quot;:&quot;XXXXXX&quot;,
       &quot;LocalID&quot;:&quot;时间戳&quot;,
       &quot;ClientMsgId&quot;:&quot;时间戳&quot;
   },
   &quot;BaseRequest&quot;:{
       &quot;Uin&quot;:&quot;XXXXXX&quot;,
       &quot;Sid&quot;:&quot;XXXXXX&quot;,
       &quot;Skey&quot;:&quot;XXXXXX&quot;,
       &quot;DeviceID&quot;:&quot;XXXXXX&quot;
   }
}" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="json hljs"><code class="json">{
   <span class="hljs-attr">"Msg"</span>:{
       <span class="hljs-attr">"Type"</span>:<span class="hljs-number">1</span>,
       <span class="hljs-attr">"Content"</span>:<span class="hljs-string">"测试信息"</span>,
       <span class="hljs-attr">"FromUserName"</span>:<span class="hljs-string">"XXXXXX"</span>,
       <span class="hljs-attr">"ToUserName"</span>:<span class="hljs-string">"XXXXXX"</span>,
       <span class="hljs-attr">"LocalID"</span>:<span class="hljs-string">"时间戳"</span>,
       <span class="hljs-attr">"ClientMsgId"</span>:<span class="hljs-string">"时间戳"</span>
   },
   <span class="hljs-attr">"BaseRequest"</span>:{
       <span class="hljs-attr">"Uin"</span>:<span class="hljs-string">"XXXXXX"</span>,
       <span class="hljs-attr">"Sid"</span>:<span class="hljs-string">"XXXXXX"</span>,
       <span class="hljs-attr">"Skey"</span>:<span class="hljs-string">"XXXXXX"</span>,
       <span class="hljs-attr">"DeviceID"</span>:<span class="hljs-string">"XXXXXX"</span>
   }
}</code></pre>
<p>这里的Content是信息内容，LocalID和ClientMsgId都用当前时间戳。</p>
<p><span class="img-wrap"><img data-src="/img/remote/1460000011996735?w=1884&amp;h=914" src="https://static.alili.tech/img/remote/1460000011996735?w=1884&amp;h=914" alt="web端微信登录" title="web端微信登录" style="cursor: pointer; display: inline;"></span></p>
<p>以上就是基本的web端微信授权登录以及收发消息的过程了，个人见解，有理解有偏差的地方还期待您的批评指正。</p>
<blockquote><p>参考文章  <br><a href="http://www.oicqzone.com/qqjiqiao/2017032723731.html" rel="nofollow noreferrer" target="_blank">微信网页web版通信协议分析 实现微信登录发送接收消息</a></p></blockquote>

                
{{< /raw >}}

# 版权声明
本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，

本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。

原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！

## 原文标题
简述网页版微信扫码登录的过程

## 原文链接
[https://segmentfault.com/a/1190000011996725](https://segmentfault.com/a/1190000011996725)

