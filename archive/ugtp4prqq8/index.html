<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.每天碰到那么多问题,终归还是需要一个记录的地方. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="基于weex的有赞无线开发框架"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.每天碰到那么多问题,终归还是需要一个记录的地方. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js"><meta property="og:site_name" content="Alili"><title>基于weex的有赞无线开发框架 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ugtp4prqq8/",
				"appid": "1613049289050283", 
				"title": "基于weex的有赞无线开发框架 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-03-02T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/jzw687hzij/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/caq64lxh2em/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f&text=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f&text=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f&title=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f&is_video=false&description=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f&title=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f&title=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f&title=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fugtp4prqq8%2f&title=%e5%9f%ba%e4%ba%8eweex%e7%9a%84%e6%9c%89%e8%b5%9e%e6%97%a0%e7%ba%bf%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">基于weex的有赞无线开发框架</h1><div class="meta"><div class="postdate"><time datetime="2019-03-02" itemprop="datePublished">2019-03-02</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.每天碰到那么多问题,终归还是需要一个记录的地方. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e出于对开发效率和动态化的要求，无线端的开发框架也一直在更新，从 Hybrid、结构化 Native View、React Native、Weex，再到现在正在大受关注的 Flutter。什么样的框架才是适合自己的团队？不仅要有技术追求，而且要考虑实际业务需要。最近，有赞移动选择了 weex 作为无线开发框架，搭建了从开发、Debug、构建、发布、数据一个闭环的流程。本文将对此进行分享。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016850044?w=359\x26amp;h=349\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016850044?w=359\x26amp;h=349\x22 alt=\x22开发闭环\x22 title=\x22开发闭环\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e一、什么是 weex\x3c\/h2\x3e\n\x3cp\x3eWeex 是阿里巴巴开源的一套构建高性能、可扩展的原生应用跨平台开发方案。首先总结一下 weex 的特点：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cstrong\x3e页面的开发目前支持\x3ca href=\x22https:\/\/alibaba.github.io\/rax\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRax\x3c\/a\x3e和\x3ca href=\x22https:\/\/vuejs.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eVue\x3c\/a\x3e\x3c\/strong\x3e\x3cp\x3eWeex 也不是只支持 Vue 和 Rax，你也可以把自己喜欢的前端框架集成到 Weex 中，有一个文档\x3ca href=\x22https:\/\/weex.incubator.apache.org\/cn\/guide\/extend-js-framework.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e扩展前端框架\x3c\/a\x3e描述了如何实现，但是这个过程仍然非常复杂和棘手，你需要了解关于 js-native 之间通信和原生渲染引擎的许多底层细节。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e一次编写，三端（Android、iOS、前端）运行\x3c\/strong\x3e\x3cp\x3e前提是都集成了 weex sdk，另外视觉表现做不到完全一样，有的会有一些差异，需要做一下适配。所以写 weex 页面的时候，如果支持三端，便需要在三端都进行自测。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3eUI 的绘制通过 native 的组件，JavaScript 逻辑在 JS 引擎里运行，两者通过 JavaScriptCore 通信\x3c\/strong\x3e\x3cp\x3eweex 里使用组件都需要在 native 端注册，这样 weex 里才可以使用，运行的时候通过注册时记录的 map 进行查找。weex sdk 内置注册了一些基础的组件，包括 list、text、input 等。WXJSCoreBridge 封装了 JavaScriptCore 实现 native 和 js 之间的通信。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e支持 Native 扩展\x3c\/strong\x3e\x3cp\x3e可以将 native 的 UI 组件封装成 component，将 native 的逻辑代码封装成 module。从而在 weex 里可以进行使用。这里的 natiev UI 组件包括 modal、webview、image 等，这里的 native 逻辑代码包括 storage、network 等。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e每个 weex 页面会被打包成一个 js 文件，weex sdk 将 js 文件渲染成一个 view\x3c\/strong\x3e\x3cbr\x3eweex 的打包通过 webpack，将每个页面打包成独立的一个 js 文件，weex sdk 会将 js 进行解析，将 UI 部分绘制成一个 view, 再绑定 view 的事件与 js 代码绑定。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e二、为什么要使用weex进行无线开发\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e1. 效率问题\x3c\/h3\x3e\n\x3cp\x3e1）开发的人力成本\x3c\/p\x3e\n\x3cp\x3e如果不算 web 端，一个页面本来需要 Android 和 iOS \x3cstrong\x3e2\x3c\/strong\x3e 个人开发；使用 weex 后只需要 \x3cstrong\x3e1\x3c\/strong\x3e 个开发页面。\x3c\/p\x3e\n\x3cp\x3e2）开发的编译速度\x3c\/p\x3e\n\x3cp\x3e随着项目渐渐变得庞大，Android 项目一次编译需要 \x3cstrong\x3e2-3 分钟\x3c\/strong\x3e，机器不好的还需要 \x3cstrong\x3e10 分钟\x3c\/strong\x3e，iOS 可能会快一点，也需要 \x3cstrong\x3e1-2 分钟\x3c\/strong\x3e。使用 weex 后，界面修改，只需要\x3cstrong\x3e十几秒\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e3）测试效率\x3c\/p\x3e\n\x3cp\x3e提测之后，发现 bug，修复完成，测试总需要重新下载一个包进行安装；使用 weex 后，跟原生无关的 bug，只要测试重启 App 就可以进行验证。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e2. 动态化\x3c\/h3\x3e\n\x3cp\x3eweex 页面最后打包完是一个 js 文件，只要能做到动态下发 JavaScript，那便可以实现动态化，可以热修复，甚至可以热部署，完全替换或者新增页面。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e3. 成熟度\x3c\/h3\x3e\n\x3cp\x3e在 2016 年阿里双十一中，Weex 在阿里双十一会场中的覆盖率接近 99%，页面数量接近 2000，覆盖了包括主会场、分会场、分分会场、人群会场在内几乎所有的阿里双十一会场业务。阿里双十一主会场秒开率97%，全部会场页面达到 93%。\x3cbr\x3e2016 年 12 月 15 日，阿里巴巴宣布将移动开源项目 Weex 捐赠给 Apache 基金会开始孵化。\x3cbr\x3e2017 年，weex 在阿里业务里增长如下图，来自 WeexConf 2018。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016850045\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016850045\x22 alt=\x22阿里业务增长\x22 title=\x22阿里业务增长\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e4. 接入成本\x3c\/h3\x3e\n\x3cp\x3e经过实践，一个移动端开发，一周时间就可以开始进行使用 weex 进行业务开发。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e三、如何使用 weex 进行无线开发\x3c\/h2\x3e\n\x3cp\x3eweex 其实是一套方案，各个流程很多东西需要自己建设，把它建设得让小伙伴可以以较小成本开始使用 weex，把它建设得融入已有的系统。这方面，我们目前做了下面这几个方面，还任重道远。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016850046\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016850046\x22 alt=\x22zanweex 建设\x22 title=\x22zanweex 建设\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e1. 开发工具 zweex-toolkit\x3c\/h3\x3e\n\x3cp\x3e这是一个脚手架工具，基于 weex 官方的 weex-toolkit，用于新建 weex 工程，目前只支持 vue。\x3c\/p\x3e\n\x3cp\x3e随着页面的增多，业务的复杂，工程会慢慢变得庞大，每次运行的时候如果全部页面都运行起来比较慢。为了解决这个问题，使用 zweex-toolkit 创建建的工程模板支持运行的时候，支持只运行指定目录下的页面，只要在 npm start 后加上参数即可，如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm run start hi,helloworld\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3enpm \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e start hi,helloworld\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样就表示只运行 hi 目录下和 helloworld 下的页面。\x3cbr\x3e另外，我们支持：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e新增页面\x3ccode\x3ezweex page\x3c\/code\x3e\n\x3c\/li\x3e\n\x3cli\x3e开启调试\x3ccode\x3ezweex debug\x3c\/code\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e2. ZanWeex SDK 的实现\x3c\/h3\x3e\n\x3cp\x3e官方 weex sdk 做的事情，就是输入一个 js 文件，然后返回一个view。考虑到每个应用的路由和个性化的需要，这一点，ZanWeex SDK 没有做其他工作，也还是返回了一个view，业务方可以根据自己的需要将view添加到自己想要展示的地方。ZanWeex SDK 做的事情主要有如下几方面：\x3c\/p\x3e\n\x3cp\x3e1）\x3cstrong\x3e支持下发配置，支持动态化，可以完成整个页面的替换\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3eweex 页面打包后的结果是一个 js 文件，所以可以进行下发进行动态更新，那么就需要有一份配置，来关联页面路由和 js 文件的关系，于是我们设计了这样的数据结构：\x3c\/p\x3e\n\x3cp\x3eh5：页面路由地址，可以直接使用发布平台生成的 h5 地址\x3c\/p\x3e\n\x3cp\x3ejs：打包后的 js 文件地址\x3c\/p\x3e\n\x3cp\x3eversion：支持的最低 App 版本，因为新页面如果需要 native 扩展，那就需要发布新版本进行支持\x3c\/p\x3e\n\x3cp\x3emd5：为了校验完整性，我们在配置里添加每个 js 文件的 md5。\x3c\/p\x3e\n\x3cp\x3e2）\x3cstrong\x3e支持多模块独立配置，互不影响\x3c\/strong\x3e\x3cbr\x3e 一个App里会有多个模块，每个模块可能由独立的团队进行负责，所以为了减少耦合，我们将配置独立，每个模块可以独立管理自己的配置，独立接入weex，不依赖于宿主App。\x3c\/p\x3e\n\x3cp\x3e3）\x3cstrong\x3e预加载页面模板，支持页面模板缓存和配置缓存\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e如果没有缓存，每次都从服务端拉取页面模板，那么是不可能达到秒开的，跟没有做缓存的H5页面就区别不大了。我们SDK会预加载页面模板到本地，打开过的页面会缓存到内存。这样渲染的时间就更接近原生的渲染时间了。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e4）\x3cstrong\x3e支持开发时的hot  reloading，前端开发般的体验\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e如果没有hot  reloading，那么每次修改完页面，都得退出页面重新进入。为了省去这个操作，hot reloading是必须的。\x3c\/li\x3e\n\x3cli\x3eweex 工程里本地开发时候，通过webpack-dev-server来启动一个websocket，zan weex sdk 打开一个weex页面后，去与它建立连接。webpack-dev-server将工程的编译状态发送给ZanWeex SDK，当接收到渲染完成的指令时，就重新渲染页面，从而达到 hot reloading的目的。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e5）\x3cstrong\x3e支持页面的适配，提供环境变量\x3c\/strong\x3e\x3cbr\x3eZanWeex SDK 会提供以下四个变量共 weex 页面使用，方便完成页面配置。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e容器的高度：weex.config.yzenv.viewHeight\x3c\/li\x3e\n\x3cli\x3e容器的宽度：weex.config.yzenv.viewWidth\x3c\/li\x3e\n\x3cli\x3e状态栏高度：weex.config.yzenv.statusBarHeight\x3c\/li\x3e\n\x3cli\x3e底部栏高度（针对iPhone X，其他为0)：weex.config.yzenv.bottomHeight\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e6）\x3cstrong\x3e开发阶段日志的查看\x3c\/strong\x3e\x3cbr\x3e在开发阶段，weex sdk 源码里输出的日志以及 js 里通过 console.log 输出的日志，还有 js 运行的报错，都只能通过 XCode 和 Android Studio 进行查看。这对于一个只了解一端的开发人员是非常不方便的。于是我们做了一个入口，在打开 weex 页面的时候，会显示该入口，点击即可查看所输出的日志。\x3c\/p\x3e\n\x3cp\x3e7）\x3cstrong\x3e参数传递\x3c\/strong\x3e\x3cbr\x3e正向传参：从 A 页面跳转到 B 页面，参数传递是开发过程肯定会遇见的一个场景。SDK  对外提供的渲染接口 renderByH5 的参数包括 url，params，data。业务方进行渲染的时候，可以将参数直接跟在 url 后面，或者通过 params、data 传入，不同方式，取的方式也不一样：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eurl 后面的参数，会传入 data，weex 页面里直接在 data 里定义参数就会自动赋值；\x3c\/li\x3e\n\x3cli\x3eparams的参数，在 weex 页面里可以通过 weex.config.name 来获取；\x3c\/li\x3e\n\x3cli\x3edata 传入的参数，获取方式同第一种。\x3c\/li\x3e\n\x3cli\x3e反向传参：从 B 页面返回到 A 页面的时候，携带参数返回也是很常见的一个场景。SDK  提供了统一的存储类 ZParamStorage 来临时存储参数。页面 B 要返回的时候先把数据存入存储区，A 页面显示的时候再从存储区获取，然后清空存储区。\x3c\/li\x3e\n\x3cli\x3e非跳转的参数传递：weex 页面之间，可以采用 BroadcastChannel 进行传参，weex 与 native 之间的传递可以通过自己封装 Module 进行实现。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e3. 页面的开发\x3c\/h3\x3e\n\x3cp\x3e前面有提到，weex 的页面目前可以采用 vue 或者 Rax 编写。对于 Vue 和 Rax 的语法这里不做陈述。这里主要总结了容易在实际开发中卡住小伙伴的几个问题。\x3c\/p\x3e\n\x3cp\x3e1）\x3cstrong\x3e如何判断一个页面是否用 weex 来实现？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e可以认为所有的新页面都可以采取 weex 来开发，区别在于这个页面使用的 native 能力有多少。可以通过自定义 Module 来调用 native 的能力，通过自定义 component 来使用 native 的组件；\x3c\/p\x3e\n\x3cp\x3e2）\x3cstrong\x3e什么时候需要自定义 Module？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3cp\x3e需要原生的能力的时候，比如：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e要调用系统选择图片的接口\x3c\/li\x3e\n\x3cli\x3e调用打电话、发短信的功能\x3c\/li\x3e\n\x3cli\x3e打开其他应用\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e调用已有的业务逻辑，比如：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e加密、解密逻辑\x3c\/li\x3e\n\x3cli\x3e登录逻辑\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e3）\x3cstrong\x3e什么时候需要自定义 component？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e如果一个组件已经使用 native 实现，为了保持统一一致，那么可以将原有的组件封装成 component\x3c\/li\x3e\n\x3cli\x3e如果一个组件不能使用 weex 实现，比如地图组件、超长图显示等\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e4）\x3cstrong\x3e多个弹层的布局如何实现？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3eweex 页面渲染的层级，是从上而下的，越在下面的布局，显示越上层。所以要作为弹层的布局，就把它放到最下面。\x3c\/p\x3e\n\x3cp\x3e5）\x3cstrong\x3e页面的动画如何实现？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e官方 weex sdk 已经封装了 animation 的 module 可以直接使用，复杂的动画可以使用 BindingX 实现。\x3c\/p\x3e\n\x3cp\x3e6）\x3cstrong\x3eweex 的代码如何复用？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e代码都可以抽离出组件。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e作为一个 UI 组件，抽离成一个组件，向外暴露属性参数和事件接口；\x3c\/li\x3e\n\x3cli\x3e作为独立的 js 函数，抽离成一个 js 供其他页面引入；\x3c\/li\x3e\n\x3cli\x3ecss 样式也可以抽离成一个 css 文件，供其他页面引入；\x3c\/li\x3e\n\x3cli\x3e如果包含多个组件形式，可以通过 mixins 来引入。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e4. 构建和打包平台\x3c\/h3\x3e\n\x3cp\x3e我们开发了以项目为单位的构建平台：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e每个项目可以添加多个分支，可以是不同仓库的分支。因为一个项目有可能是跨团队跨模块的，但是需要一起发布。\x3c\/li\x3e\n\x3cli\x3e构建通过 webpack 构建，构建之后，支持发布线下存储和线上 cdn\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e我们还开发了以应用为单位的 weex 发布平台：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e这里的应用是一个抽象概念，不是传统的“应用”，可以理解成模块\x3c\/li\x3e\n\x3cli\x3e业务方可以在构建平台构建完成后，一键跳转到发布平台进行发布，除了需要第一次填写最低支持的版本号，其他均无需操作。\x3c\/li\x3e\n\x3cli\x3e发布平台支持灰度发布、全量发布和回滚。\x3c\/li\x3e\n\x3cli\x3e发布平台会展示 weex 在端上的使用情况，渲染时间、渲染错误、下载时间等\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e四、遇到的问题以及解决方案\x3c\/h2\x3e\n\x3cp\x3e在开发过程中，很多问题，可以通过阅读源码来解决，比如：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e使用 iconfont 的时候，是否已支持缓存?\x3cp\x3e答：已支持，包括内存缓存和文件缓存，内存缓存使用 familyname 来做 key，文件缓存使用 md5(url) 来做本地文件名\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3emodule实现的函数能不能返回参数？\x3cp\x3e答：module 的函数氛围 UIThread 和 JSThread，JSThread 对于 js 线程来说是同步的，支持直接返回参数；UIThread 对于 JS 线程来说是异步的，不支持直接返回参数，只能使用 callback\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e另外，很多常见的问题，我们已经在 ZanWeexSDK 进行了解决，包括实现动态化、多模块的支持、缓存管理、Hot Reloading、日志查看、页面适配、参数传递等。\x3c\/p\x3e\n\x3cp\x3e此外，还会有一些常见的问题，在此罗列一下：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e配置的更新机制是怎样的？更新失败，如何打开 weex 页面？\x3cp\x3e答： 配置的更新接口开放给业务方调用，由业务方决定什么时候调用更新接口；SDK 里做了三种处理，来尽量保证配置可以更新成功：\x3c\/p\x3e\n\x3cp\x3e1）配置接口拉取失败后，会有三次重试；\x3c\/p\x3e\n\x3cp\x3e2）网络从无网变成有网时，sdk 会检查配置是否已拉取，如果未拉取就主动拉取\x3c\/p\x3e\n\x3cp\x3e3）允许业务方内置配置和 js 文件，当拉取失败后，SDK里会从内置配置里读取\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e配置的版本管理是怎样的？\x3cp\x3e答：配置每次发布的时候，都会指定该发布支持的 App 最低版本号。每次请求，会携带 App 版本号，服务端只会返回符合该版本号的最新配置。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e支持不支持屏幕旋转？\x3cp\x3e答：答案是支持的。旋转之后，屏幕变成了横屏，weex 就按照横屏的尺寸来渲染，问题是只要你写的页面符合这种变化就可以了，跟 native 来实现页面没有什么区别。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3e五、未来还要继续做的事情\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e组件库的建设\x3c\/li\x3e\n\x3cli\x3e性能统计，比如帧率、内存、CPU\x3c\/li\x3e\n\x3cli\x3e配置和js文件的增量更新、推送更新\x3c\/li\x3e\n\x3cli\x3e降级处理\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bV50Mk?w=640\x26amp;h=400\x22 src=\x22https:\/\/static.alili.tech\/img\/bV50Mk?w=640\x26amp;h=400\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>基于weex的有赞无线开发框架</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016850041">https://segmentfault.com/a/1190000016850041</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/ugtp4prqq8/" target="_blank">https://alili.tech/archive/ugtp4prqq8/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/mrwjjr0ca4i/">2019年05月Github Javascript开源项目精选<aside class="dates">2019-05-08</aside></a></li><li><a href="/archive/3xwbcv1w21i/">前端微服务化进阶2 - 本地开发指南<aside class="dates">2019-04-22</aside></a></li><li><a href="/archive/9xuojm75d2a/">前端微服务化进阶1 - 基于umi的子模块方案<aside class="dates">2019-04-13</aside></a></li><li><a href="/archive/ol9qis0n8xe/">2019年04月Github Javascript开源项目精选<aside class="dates">2019-04-08</aside></a></li><li><a href="/archive/7815p445rtf/">记一次MongoDB迁移 - 备份与恢复<aside class="dates">2019-03-27</aside></a></li><li><a href="/archive/a5ficy1jp7n/">2019年03月Github Javascript开源项目精选<aside class="dates">2019-03-08</aside></a></li><li><a href="/archive/nyhmtbanv2e/">Alili Weekly 前端周刊 第二十一期<aside class="dates">2019-03-08</aside></a></li><li><a href="/archive/304a32r2py8/">30分钟精通React今年最劲爆的新特性——React Hooks<aside class="dates">2019-03-02</aside></a></li><li><a href="/archive/sj4oqgzx0rk/">CSS6：flex布局<aside class="dates">2019-03-02</aside></a></li><li><a href="/archive/wedm7eypuhb/">ES6 系列之 Babel 将 Async 编译成了什么样子<aside class="dates">2019-03-02</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>