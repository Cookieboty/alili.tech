<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="关于 ES6 中 Promise 的面试题"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>关于 ES6 中 Promise 的面试题 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/yheesma5d9q/",
				"appid": "1613049289050283", 
				"title": "关于 ES6 中 Promise 的面试题 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-03-02T02:30:07"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/k4xqwcnq7g/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/6x8i1yz9vfj/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f&text=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f&text=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f&title=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f&is_video=false&description=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f&title=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f&title=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f&title=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyheesma5d9q%2f&title=%e5%85%b3%e4%ba%8e%20ES6%20%e4%b8%ad%20Promise%20%e7%9a%84%e9%9d%a2%e8%af%95%e9%a2%98"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">关于 ES6 中 Promise 的面试题</h1><div class="meta"><div class="postdate"><time datetime="2019-03-02" itemprop="datePublished">2019-03-02</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3e说明\x3c\/h3\x3e\n\x3cp\x3e最近在复习 Promise 的知识，所以就做了一些题，这里挑出几道题，大家一起看看吧。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e题目一\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const promise = new Promise((resolve, reject) =\x3e {\n    console.log(1);\n    resolve();\n    console.log(2);\n})\n\npromise.then(() =\x3e {\n    console.log(3);\n})\n\nconsole.log(4);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n    resolve();\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n})\n\npromise.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e);\n})\n\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e解析\x3c\/h3\x3e\n\x3cp\x3e首先 Promise 新建后立即执行，所以会先输出 1，2，而 \x3ccode\x3ePromise.then() \x3c\/code\x3e 内部的代码在 当次 事件循环的 结尾 立刻执行 ，所以会继续输出4，最后输出3。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e答案\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221\n2\n4\n3\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e题目二\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const promise = new Promise((resolve, reject) =\x3e {\n    resolve(\x27success1\x27);\n    reject(\x27error\x27);\n    resolve(\x27success2\x27);\n});\n\npromise.then((res) =\x3e {\n    console.log(\x27then:\x27, res);\n}).catch((err) =\x3e {\n    console.log(\x27catch:\x27, err);\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e promise = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27success1\x27\x3c\/span\x3e);\n    reject(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e);\n    resolve(\x3cspan class=\x22hljs-string\x22\x3e\x27success2\x27\x3c\/span\x3e);\n});\n\npromise.then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27then:\x27\x3c\/span\x3e, res);\n}).catch(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27catch:\x27\x3c\/span\x3e, err);\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e解析\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3eresolve 函数\x3c\/code\x3e将 Promise 对象的状态从\x3ccode\x3e“未完成”变为“成功”\x3c\/code\x3e（即从 \x3ccode\x3epending 变为 resolved\x3c\/code\x3e），在异步操作成功时调用，并将异步操作的结果，作为参数传递出去；\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ereject 函数\x3c\/code\x3e将 Promise 对象的状态从\x3ccode\x3e“未完成”变为“失败”\x3c\/code\x3e（即从 \x3ccode\x3epending 变为 rejected\x3c\/code\x3e），在异步操作失败时调用，并将异步操作报出的错误，作为参数传递出去。\x3c\/p\x3e\n\x3cp\x3e而一旦状态改变，就不会再变。\x3cbr\x3e所以 代码中的\x3ccode\x3ereject(\x27error\x27);\x3c\/code\x3e 不会有作用。\x3c\/p\x3e\n\x3cp\x3ePromise 只能 resolve 一次，剩下的调用都会被忽略。\x3cbr\x3e所以 第二次的 \x3ccode\x3eresolve(\x27success2\x27);\x3c\/code\x3e 也不会有作用。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e答案\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22then: success1\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e: success1\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e题目三\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Promise.resolve(1)\n  .then(2)\n  .then(Promise.resolve(3))\n  .then(console.log)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n  .then(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e)\n  .then(\x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve(\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e))\n  .then(\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log)\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e解析\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3ePromise.resolve\x3c\/code\x3e 方法的参数如果是一个原始值，或者是一个不具有 \x3ccode\x3ethen\x3c\/code\x3e 方法的对象，则 \x3ccode\x3ePromise.resolve\x3c\/code\x3e 方法返回一个新的 \x3ccode\x3ePromise\x3c\/code\x3e 对象，状态为\x3ccode\x3eresolved\x3c\/code\x3e，\x3ccode\x3ePromise.resolve\x3c\/code\x3e 方法的参数，会同时传给回调函数。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ethen\x3c\/code\x3e 方法接受的参数是函数，而如果传递的并非是一个函数，它实际上会将其解释为 \x3ccode\x3ethen(null)\x3c\/code\x3e，这就会导致前一个 \x3ccode\x3ePromise\x3c\/code\x3e 的结果会穿透下面。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e答案\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e题目四\x3c\/h3\x3e\n\x3cp\x3e红灯三秒亮一次，绿灯一秒亮一次，黄灯2秒亮一次；如何让三个灯不断交替重复亮灯？（用Promse实现）三个亮灯函数已经存在：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function red() {\n    console.log(\x27red\x27);\n}\nfunction green() {\n    console.log(\x27green\x27);\n}\nfunction yellow() {\n    console.log(\x27yellow\x27);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ered\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e);\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egreen\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27green\x27\x3c\/span\x3e);\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eyellow\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27yellow\x27\x3c\/span\x3e);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e解析\x3c\/h3\x3e\n\x3cp\x3e红灯三秒亮一次，绿灯一秒亮一次，黄灯2秒亮一次，意思就是3秒，执行一次 red 函数，2秒执行一次 green 函数，1秒执行一次 yellow 函数，不断交替重复亮灯，意思就是按照这个顺序一直执行这3个函数，这步可以就利用递归来实现。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e答案\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function red() {\n    console.log(\x27red\x27);\n}\nfunction green() {\n    console.log(\x27green\x27);\n}\nfunction yellow() {\n    console.log(\x27yellow\x27);\n}\n\nvar light = function (timmer, cb) {\n    return new Promise(function (resolve, reject) {\n        setTimeout(function () {\n            cb();\n            resolve();\n        }, timmer);\n    });\n};\n\nvar step = function () {\n    Promise.resolve().then(function () {\n        return light(3000, red);\n    }).then(function () {\n        return light(2000, green);\n    }).then(function () {\n        return light(1000, yellow);\n    }).then(function () {\n        step();\n    });\n}\n\nstep();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ered\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27red\x27\x3c\/span\x3e);\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egreen\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27green\x27\x3c\/span\x3e);\n}\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eyellow\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27yellow\x27\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e light = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3etimmer, cb\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) \x3c\/span\x3e{\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            cb();\n            resolve();\n        }, timmer);\n    });\n};\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e step = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve().then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e light(\x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e, red);\n    }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e light(\x3cspan class=\x22hljs-number\x22\x3e2000\x3c\/span\x3e, green);\n    }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e light(\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e, yellow);\n    }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        step();\n    });\n}\n\nstep();\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3e题目五\x3c\/h3\x3e\n\x3cp\x3e实现 mergePromise 函数，把传进去的数组按顺序先后执行，并且把返回的数据先后放到数组 data 中。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const timeout = ms =\x3e new Promise((resolve, reject) =\x3e {\n    setTimeout(() =\x3e {\n        resolve();\n    }, ms);\n});\n\nconst ajax1 = () =\x3e timeout(2000).then(() =\x3e {\n    console.log(\x271\x27);\n    return 1;\n});\n\nconst ajax2 = () =\x3e timeout(1000).then(() =\x3e {\n    console.log(\x272\x27);\n    return 2;\n});\n\nconst ajax3 = () =\x3e timeout(2000).then(() =\x3e {\n    console.log(\x273\x27);\n    return 3;\n});\n\nconst mergePromise = ajaxArray =\x3e {\n    \/\/ 在这里实现你的代码\n\n};\n\nmergePromise([ajax1, ajax2, ajax3]).then(data =\x3e {\n    console.log(\x27done\x27);\n    console.log(data); \/\/ data 为 [1, 2, 3]\n});\n\n\/\/ 要求分别输出\n\/\/ 1\n\/\/ 2\n\/\/ 3\n\/\/ done\n\/\/ [1, 2, 3]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e timeout = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ems\x3c\/span\x3e =\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        resolve();\n    }, ms);\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ajax1 = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e timeout(\x3cspan class=\x22hljs-number\x22\x3e2000\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x271\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ajax2 = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e timeout(\x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x272\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e ajax3 = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e timeout(\x3cspan class=\x22hljs-number\x22\x3e2000\x3c\/span\x3e).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x273\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e;\n});\n\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e mergePromise = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eajaxArray\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在这里实现你的代码\x3c\/span\x3e\n\n};\n\nmergePromise([ajax1, ajax2, ajax3]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27done\x27\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ data 为 [1, 2, 3]\x3c\/span\x3e\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 要求分别输出\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 1\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 2\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 3\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ done\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ [1, 2, 3]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e解析\x3c\/h3\x3e\n\x3cp\x3e首先 \x3ccode\x3eajax1 、ajax2、ajax3\x3c\/code\x3e 都是函数，只是这些函数执行后会返回一个 \x3ccode\x3ePromise\x3c\/code\x3e，按题目的要求我们只要顺序执行这三个函数就好了，然后把结果放到 \x3ccode\x3edata\x3c\/code\x3e 中，但是这些函数里都是异步操作，想要按顺序执行，然后输出 1，2，3并没有那么简单，看个例子。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function A() {\n    setTimeout(function () {\n        console.log(\x27a\x27);\n    }, 3000);\n}\n\nfunction B() {\n    setTimeout(function () {\n        console.log(\x27b\x27);\n    }, 1000);\n}\n\nA();\nB();\n\n\/\/ b\n\/\/ a\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eA\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e);\n    }, \x3cspan class=\x22hljs-number\x22\x3e3000\x3c\/span\x3e);\n}\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eB\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27b\x27\x3c\/span\x3e);\n    }, \x3cspan class=\x22hljs-number\x22\x3e1000\x3c\/span\x3e);\n}\n\nA();\nB();\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ b\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ a\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例子中我们是按顺序执行的 \x3ccode\x3eA\x3c\/code\x3e，\x3ccode\x3eB\x3c\/code\x3e 但是输出的结果却是 \x3ccode\x3eb\x3c\/code\x3e，\x3ccode\x3ea\x3c\/code\x3e 对于这些异步函数来说，并不会按顺序执行完一个，再执行后一个。\x3cbr\x3e这道题就是考用 \x3ccode\x3ePromise\x3c\/code\x3e 控制异步流程，我们要想办法，让这些函数，一个执行完之后，再执行下一个，看答案吧。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3e答案\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 保存数组中的函数执行后的结果\nvar data = [];\n\n\/\/ Promise.resolve方法调用时不带参数，直接返回一个resolved状态的 Promise 对象。\nvar sequence = Promise.resolve();\n\najaxArray.forEach(function (item) {\n    \/\/ 第一次的 then 方法用来执行数组中的每个函数，\n    \/\/ 第二次的 then 方法接受数组中的函数执行后返回的结果，\n    \/\/ 并把结果添加到 data 中，然后把 data 返回。\n    sequence = sequence.then(item).then(function (res) {\n        data.push(res);\n        return data;\n    });\n})\n\n\/\/ 遍历结束后，返回一个 Promise，也就是 sequence， 他的 [[PromiseValue]] 值就是 data，\n\/\/ 而 data（保存数组中的函数执行后的结果） 也会作为参数，传入下次调用的 then 方法中。\nreturn sequence;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 保存数组中的函数执行后的结果\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = [];\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ Promise.resolve方法调用时不带参数，直接返回一个resolved状态的 Promise 对象。\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e sequence = \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve();\n\najaxArray.forEach(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eitem\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 第一次的 then 方法用来执行数组中的每个函数，\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 第二次的 then 方法接受数组中的函数执行后返回的结果，\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 并把结果添加到 data 中，然后把 data 返回。\x3c\/span\x3e\n    sequence = sequence.then(item).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) \x3c\/span\x3e{\n        data.push(res);\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e data;\n    });\n})\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 遍历结束后，返回一个 Promise，也就是 sequence， 他的 [[PromiseValue]] 值就是 data，\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 而 data（保存数组中的函数执行后的结果） 也会作为参数，传入下次调用的 then 方法中。\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sequence;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3e题目六\x3c\/h3\x3e\n\x3cp\x3e以下代码最后输出什么？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const first = () =\x3e (new Promise((resolve, reject) =\x3e {\n    console.log(3);\n    let p = new Promise((resolve, reject) =\x3e {\n        console.log(7);\n        setTimeout(() =\x3e {\n            console.log(5);\n            resolve(6);\n        }, 0)\n        resolve(1);\n    });\n    resolve(2);\n    p.then((arg) =\x3e {\n        console.log(arg);\n    });\n\n}));\n\nfirst().then((arg) =\x3e {\n    console.log(arg);\n});\nconsole.log(4);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e first = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e p = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e);\n        setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e);\n            resolve(\x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e);\n        }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n        resolve(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n    });\n    resolve(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n    p.then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3earg\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(arg);\n    });\n\n}));\n\nfirst().then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3earg\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(arg);\n});\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader17\x22\x3e解析\x3c\/h3\x3e\n\x3cp\x3e这道题就其实和 \x3ccode\x3ePromise\x3c\/code\x3e 的关系不太大，主要是需要理解 JS执行机制，才能很好的解决这道题，对于 JS 执行机制不了解的朋友推荐看看这篇文章 \x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/juejin.im\/post\/59e85eebf265da430d571f89\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这一次，彻底弄懂 JavaScript 执行机制\x3c\/a\x3e\x3c\/p\x3e\n\x3ch4\x3e第一轮事件循环\x3c\/h4\x3e\n\x3cp\x3e先执行宏任务，主script ，new Promise立即执行，输出【3】，\x3cbr\x3e执行 p 这个new Promise 操作，输出【7】，\x3cbr\x3e发现 setTimeout，将回调放入下一轮任务队列（Event Queue），p 的 then，姑且叫做 then1，放入微任务队列，发现 first 的 then，叫 then2，放入微任务队列。执行\x3ccode\x3econsole.log(4)\x3c\/code\x3e，输出【4】，宏任务执行结束。\x3cbr\x3e再执行微任务，执行 then1，输出【1】，\x3cbr\x3e执行 then2，输出【2】。\x3cbr\x3e到此为止，第一轮事件循环结束。开始执行第二轮。\x3c\/p\x3e\n\x3ch4\x3e第二轮事件循环\x3c\/h4\x3e\n\x3cp\x3e先执行宏任务里面的，也就是 setTimeout 的回调，输出【5】。\x3cbr\x3e\x3ccode\x3eresolve(6)\x3c\/code\x3e 不会生效，因为 p 这个 Promise 的状态一旦改变就不会在改变了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader18\x22\x3e答案\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x223\n7\n4\n1\n2\n5 \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e7\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e \x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader19\x22\x3e题目七\x3c\/h3\x3e\n\x3cp\x3e有 8 个图片资源的 url，已经存储在数组 \x3ccode\x3eurls\x3c\/code\x3e 中（即\x3ccode\x3eurls = [\x27http:\/\/example.com\/1.jpg\x27, ...., \x27http:\/\/example.com\/8.jpg\x27]）\x3c\/code\x3e，而且已经有一个函数 \x3ccode\x3efunction loadImg\x3c\/code\x3e，输入一个 url 链接，返回一个 Promise，该 Promise 在图片下载完成的时候 resolve，下载失败则 reject。\x3cbr\x3e但是我们要求，任意时刻，同时下载的链接数量不可以超过 3 个。\x3cbr\x3e请写一段代码实现这个需求，要求尽可能快速地将所有图片下载完成。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var urls = [\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/getImgDatadata.jpg\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/gray.gif\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/Particle.gif\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic.png\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic2.gif\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/getImgDataError.jpg\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic.gif\x27, \x27https:\/\/www.kkkk1000.com\/images\/wxQrCode2.png\x27];\nfunction loadImg(url) {\n    return new Promise((resolve, reject) =\x3e {\n        const img = new Image()\n        img.onload = function () {\n            console.log(\x27一张图片加载完成\x27);\n            resolve();\n        }\n        img.onerror = reject\n        img.src = url\n    })\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e urls = [\x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/getImgDatadata.jpg\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/gray.gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/Particle.gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic.png\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic2.gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/getImgDataError.jpg\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic.gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/wxQrCode2.png\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eloadImg\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e img = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Image()\n        img.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27一张图片加载完成\x27\x3c\/span\x3e);\n            resolve();\n        }\n        img.onerror = reject\n        img.src = url\n    })\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader20\x22\x3e解析\x3c\/h3\x3e\n\x3cp\x3e题目的意思是需要我们这么做，先并发请求 3 张图片，当一张图片加载完成后，又会继续发起一张图片的请求，让并发数保持在 3 个，直到需要加载的图片都全部发起请求。\x3c\/p\x3e\n\x3cp\x3e用 Promise 来实现就是，先并发请求3个图片资源，这样可以得到 3 个 Promise，组成一个数组，就叫\x3ccode\x3epromises \x3c\/code\x3e 吧，然后不断的调用 \x3ca href=\x22http:\/\/es6.ruanyifeng.com\/#docs\/promise#Promise-race\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePromise.race\x3c\/a\x3e 来返回最快改变状态的 Promise，然后从数组（\x3ccode\x3epromises \x3c\/code\x3e）中删掉这个 Promise 对象，再加入一个新的 Promise，直到全部的 url 被取完，最后再使用 \x3ca href=\x22http:\/\/es6.ruanyifeng.com\/#docs\/promise#Promise-all\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePromise.all\x3c\/a\x3e 来处理一遍数组（\x3ccode\x3epromises \x3c\/code\x3e）中没有改变状态的 Promise。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader21\x22\x3e答案\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var urls = [\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/getImgDatadata.jpg\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/gray.gif\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/Particle.gif\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic.png\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic2.gif\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/getImgDataError.jpg\x27, \x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic.gif\x27, \x27https:\/\/www.kkkk1000.com\/images\/wxQrCode2.png\x27];\nfunction loadImg(url) {\n    return new Promise((resolve, reject) =\x3e {\n        const img = new Image()\n        img.onload = function () {\n            console.log(\x27一张图片加载完成\x27);\n            resolve();\n        }\n        img.onerror = reject\n        img.src = url\n    })\n};\n\nfunction limitLoad(urls, handler, limit) {\n    \/\/ 对数组做一个拷贝\n    const sequence = [].concat(urls)\n    let promises = [];\n\n    \/\/并发请求到最大数\n    promises = sequence.splice(0, limit).map((url, index) =\x3e {\n        \/\/ 这里返回的 index 是任务在 promises 的脚标，用于在 Promise.race 之后找到完成的任务脚标\n        return handler(url).then(() =\x3e {\n            return index\n        }); \n    });\n\n    \/\/ 利用数组的 reduce 方法来以队列的形式执行\n    return sequence.reduce((last, url, currentIndex) =\x3e {\n        return last.then(() =\x3e {\n            \/\/ 返回最快改变状态的 Promise\n            return Promise.race(promises)\n        }).catch(err =\x3e {\n            \/\/ 这里的 catch 不仅用来捕获 前面 then 方法抛出的错误\n            \/\/ 更重要的是防止中断整个链式调用\n            console.error(err)\n        }).then((res) =\x3e {\n            \/\/ 用新的 Promise 替换掉最快改变状态的 Promise\n            promises[res] = handler(sequence[currentIndex]).then(() =\x3e { return res });\n        })\n    }, Promise.resolve()).then(() =\x3e {\n        return Promise.all(promises)\n    })\n\n}\nlimitLoad(urls, loadImg, 3)\n\n\/*\n因为 limitLoad 函数也返回一个 Promise，所以当 所有图片加载完成后，可以继续链式调用\n\nlimitLoad(urls, loadImg, 3).then(() =\x3e {\n    console.log(\x27所有图片加载完成\x27);\n}).catch(err =\x3e {\n    console.error(err);\n})\n*\/\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e urls = [\x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/getImgDatadata.jpg\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/gray.gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/Particle.gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic.png\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic2.gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/getImgDataError.jpg\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/getImgData\/arithmetic.gif\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/www.kkkk1000.com\/images\/wxQrCode2.png\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eloadImg\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eresolve, reject\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e img = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Image()\n        img.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27一张图片加载完成\x27\x3c\/span\x3e);\n            resolve();\n        }\n        img.onerror = reject\n        img.src = url\n    })\n};\n\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3elimitLoad\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurls, handler, limit\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 对数组做一个拷贝\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e sequence = [].concat(urls)\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e promises = [];\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/并发请求到最大数\x3c\/span\x3e\n    promises = sequence.splice(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, limit).map(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl, index\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里返回的 index 是任务在 promises 的脚标，用于在 Promise.race 之后找到完成的任务脚标\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e handler(url).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e index\n        }); \n    });\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 利用数组的 reduce 方法来以队列的形式执行\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e sequence.reduce(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3elast, url, currentIndex\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e last.then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回最快改变状态的 Promise\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.race(promises)\n        }).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里的 catch 不仅用来捕获 前面 then 方法抛出的错误\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 更重要的是防止中断整个链式调用\x3c\/span\x3e\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error(err)\n        }).then(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 用新的 Promise 替换掉最快改变状态的 Promise\x3c\/span\x3e\n            promises[res] = handler(sequence[currentIndex]).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e { \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res });\n        })\n    }, \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.resolve()).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.all(promises)\n    })\n\n}\nlimitLoad(urls, loadImg, \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e)\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/*\n因为 limitLoad 函数也返回一个 Promise，所以当 所有图片加载完成后，可以继续链式调用\n\nlimitLoad(urls, loadImg, 3).then(() =\x26gt; {\n    console.log(\x27所有图片加载完成\x27);\n}).catch(err =\x26gt; {\n    console.error(err);\n})\n*\/\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader22\x22\x3e总结\x3c\/h3\x3e\n\x3cp\x3e这几道题，有考查 Promise 基础知识的，也有考对 Promise 灵活运用的，如果这些题你都做的很好的话，那你对 Promise 的理解应该是不错的了。\x3c\/p\x3e\n\x3cp\x3e最后，如果文中有不足或者错误的地方，还请小伙伴们指出，万分感谢。\x3cbr\x3e如果觉得文章说的内容不够，最后有与题目相关的文章，可以看看。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader23\x22\x3e参考\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/es6.ruanyifeng.com\/#docs\/promise\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eECMAScript 6 入门 —— 阮一峰\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/juejin.im\/post\/5bc5e114e51d450e632277aa\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eES6 系列之我们来聊聊 Promise\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/dojo-lzz\/p\/5495671.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e一道关于Promise应用的面试题\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/amingxiansen\/p\/9351415.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e阿里前端测试题--关于ES6中Promise函数的理解与应用\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/juejin.im\/post\/59e85eebf265da430d571f89\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这一次，彻底弄懂 JavaScript 执行机制\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/lzlu\/Blog\/issues\/7\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e一个Promise面试题\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/xuning\/p\/8045946.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eES6原生Promise的所有方法介绍（附一道应用场景题目）\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/29792886\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePromise 异步流程控制\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016248923?w=600\x26amp;h=342\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016248923?w=600\x26amp;h=342\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>关于 ES6 中 Promise 的面试题</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016848192">https://segmentfault.com/a/1190000016848192</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/yheesma5d9q/" target="_blank">https://alili.tech/archive/yheesma5d9q/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/7815p445rtf/">MongoDB - 备份与恢复<aside class="dates">2019-03-27</aside></a></li><li><a href="/archive/a5ficy1jp7n/">2019年03月Github Javascript开源项目精选<aside class="dates">2019-03-08</aside></a></li><li><a href="/archive/nyhmtbanv2e/">Alili Weekly 前端周刊 第二十一期<aside class="dates">2019-03-08</aside></a></li><li><a href="/archive/304a32r2py8/">30分钟精通React今年最劲爆的新特性——React Hooks<aside class="dates">2019-03-02</aside></a></li><li><a href="/archive/sj4oqgzx0rk/">CSS6：flex布局<aside class="dates">2019-03-02</aside></a></li><li><a href="/archive/wedm7eypuhb/">ES6 系列之 Babel 将 Async 编译成了什么样子<aside class="dates">2019-03-02</aside></a></li><li><a href="/archive/cazifdrck0u/">ES6 系列之我们来聊聊 Async<aside class="dates">2019-03-02</aside></a></li><li><a href="/archive/0dlsi4qmvsvf/">Express的基本使用<aside class="dates">2019-03-02</aside></a></li><li><a href="/archive/183cav6qpdb/">JavaScript常用八种继承方案<aside class="dates">2019-03-02</aside></a></li><li><a href="/archive/5tpnsqmgslq/">React 手稿 - Component state<aside class="dates">2019-03-02</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>