---
title: '小程序开发技巧总结' 
date: 2018-11-22 11:48:10
hidden: true
slug: 7qkruhu2698
categories: [reprint]
---

{{< raw >}}
<h3 id="articleHeader0">&#x524D;&#x8A00;</h3><p>&#x6700;&#x8FD1;&#x516C;&#x53F8;&#x8981;&#x5F00;&#x53D1;&#x4E00;&#x6B3E;&#x7535;&#x5546;&#x5C0F;&#x7A0B;&#x5E8F;&#xFF0C;&#x5306;&#x5FD9;&#x770B;&#x4E86;&#x4E00;&#x904D;&#x6587;&#x6863;&#x5C31;&#x5F00;&#x59CB;&#x5E72;&#x6D3B;&#x4E86;&#x3002;&#x6574;&#x4F53;&#x5F00;&#x53D1;&#x4F53;&#x9A8C;&#x4E2A;&#x4EBA;&#x611F;&#x89C9;&#x4E0D;&#x592A;&#x597D;&#xFF0C;&#x7279;&#x522B;&#x662F;&#x5982;&#x679C;&#x4E4B;&#x524D;&#x4E60;&#x60EF;&#x4E86;Vue&#x5F00;&#x53D1;&#xFF0C;&#x7A81;&#x7136;&#x53BB;&#x5F00;&#x53D1;&#x5C0F;&#x7A0B;&#x5E8F;&#xFF0C;&#x611F;&#x89C9;&#x5F88;&#x9E21;&#x808B;&#x3002;&#x4EE5;&#x4E0B;&#x662F;&#x6211;&#x5728;&#x5F00;&#x53D1;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#x4EE5;&#x53CA;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x7684;&#x603B;&#x7ED3;&#xFF0C;&#x4EC5;&#x4F9B;&#x53C2;&#x8003;</p><h3 id="articleHeader1">&#x5F15;&#x5165;iconfont</h3><p>&#x5728;&#x5C0F;&#x7A0B;&#x5E8F;&#x4E2D;&#x5F15;&#x5165;&#x5B57;&#x4F53;&#x56FE;&#x6807;&#x8981;&#x6BD4;web&#x9EBB;&#x70E6;&#x4E00;&#x4E9B;&#xFF0C;&#x7B80;&#x5355;&#x8BF4;&#x9700;&#x8981;&#x4E09;&#x6B65;&#xFF1A;</p><ol><li>&#x4E0B;&#x8F7D;iconfont&#xFF0C;&#x628A;iconfont.css&#x590D;&#x5236;&#x5230;iconfont.wxss&#xFF0C;&#x5728;app.wxss&#x4E2D;&#x5F15;&#x5165;</li><li>&#x67E5;&#x770B;iconfont&#x5728;unicode&#x6A21;&#x5F0F;&#x4E0B;&#x7684;&#x5728;&#x7EBF;&#x94FE;&#x63A5;&#xFF0C;&#x66FF;&#x6362;iconfont.wxss&#x4E2D;&#x7684;&#x94FE;&#x63A5;&#x4E3A;&#x8FDC;&#x7A0B;&#x94FE;&#x63A5;</li></ol><p><span class="img-wrap"><img data-src="https://user-gold-cdn.xitu.io/2018/7/18/164acd3f5a125017?w=745&amp;h=306&amp;f=png&amp;s=15841" src="https://static.alili.techhttps://user-gold-cdn.xitu.io/2018/7/18/164acd3f5a125017?w=745&amp;h=306&amp;f=png&amp;s=15841" alt="" title="" style="cursor:pointer"></span></p><ol><li>&#x5728;wxml&#x6587;&#x4EF6;&#x4E2D;&#x5F15;&#x5165;&#x5BF9;&#x5E94;&#x7684;icon class</li></ol><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="&lt;icon class=&quot;iconfont icon-pay&quot;&gt;&lt;/icon&gt;" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="xml hljs"><code class="html" style="word-break:break-word;white-space:initial"><span class="hljs-tag">&lt;<span class="hljs-name">icon</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;iconfont icon-pay&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">icon</span>&gt;</span></code></pre><h3 id="articleHeader2">&#x4F7F;&#x7528;less</h3><p>vscode&#x6709;&#x4E00;&#x4E2A;easy less&#x63D2;&#x4EF6;&#xFF0C;&#x662F;&#x6211;&#x611F;&#x89C9;&#x4F7F;&#x7528;less&#x6700;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x5F0F;</p><ol><li>vscode&#x5B89;&#x88C5;easy less&#x63D2;&#x4EF6;</li><li>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;less&#x76EE;&#x5F55;&#xFF0C;&#x7528;&#x4E8E;&#x5B58;&#x653E;less&#x6587;&#x4EF6;</li><li>&#x6587;&#x4EF6;&#x5934;&#x90E8;&#x6DFB;&#x52A0;&#x7F16;&#x8BD1;&#x6CE8;&#x91CA; <code>// out: ../pages/index/index.wxss, compress: true, sourceMap: false</code></li><li>ctrl + s&#x4FDD;&#x5B58;&#x540E;&#x81EA;&#x52A8;&#x7F16;&#x8BD1;</li></ol><p><span class="img-wrap"><img data-src="https://user-gold-cdn.xitu.io/2018/7/18/164acd3513b333e9?w=696&amp;h=291&amp;f=png&amp;s=12171" src="https://static.alili.techhttps://user-gold-cdn.xitu.io/2018/7/18/164acd3513b333e9?w=696&amp;h=291&amp;f=png&amp;s=12171" alt="" title="" style="cursor:pointer"></span></p><p>&#x7F16;&#x8BD1;&#x540E;&#x7684;&#x7ED3;&#x679C;</p><p><span class="img-wrap"><img data-src="https://user-gold-cdn.xitu.io/2018/7/18/164acd3afb5eab01?w=753&amp;h=460&amp;f=png&amp;s=89714" src="https://static.alili.techhttps://user-gold-cdn.xitu.io/2018/7/18/164acd3afb5eab01?w=753&amp;h=460&amp;f=png&amp;s=89714" alt="" title="" style="cursor:pointer"></span></p><h3 id="articleHeader3">&#x6309;&#x94AE;&#x91CD;&#x7F6E;</h3><p>&#x5C0F;&#x7A0B;&#x5E8F;&#x4E2D;&#x7684;&#x6309;&#x94AE;&#x529F;&#x80FD;&#x5F3A;&#x5927;&#xFF0C;&#x5F88;&#x591A;&#x529F;&#x80FD;&#x5FC5;&#x987B;&#x8981;&#x7528;&#x6309;&#x94AE;&#xFF0C;&#x6BD4;&#x5982;&#x5F39;&#x51FA;&#x7528;&#x6237;&#x6388;&#x6743;&#xFF0C;&#x8C03;&#x7528;&#x5BA2;&#x670D;&#x529F;&#x80FD;&#x3002;&#x9ED8;&#x8BA4;&#x7684;&#x6837;&#x5F0F;&#x4E00;&#x822C;&#x65E0;&#x6CD5;&#x6EE1;&#x8DB3;&#x9700;&#x6C42;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;&#x6309;&#x94AE;&#x6837;&#x5F0F;&#x7EDF;&#x4E00;&#x91CD;&#x7F6E;&#xFF0C;&#x7136;&#x540E;&#x81EA;&#x5DF1;&#x5199;&#x6837;&#x5F0F;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="button {
  padding: 0;
  background: #fff;
  line-height: 0;
  &amp;::after {
    border-color: transparent;
  }
}
.button-hover {
  background: #fff;
}" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="css hljs"><code class="css"><span class="hljs-selector-tag">button</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">0</span>;
  &amp;::after {
    <span class="hljs-attribute">border-color</span>: transparent;
  }
}
<span class="hljs-selector-class">.button-hover</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
}</code></pre><h3 id="articleHeader4">&#x652F;&#x6301;async-await</h3><p>async-await&#x662F;ES7&#x7684;&#x8BED;&#x6CD5;&#xFF0C;&#x622A;&#x6B62;&#x6211;&#x5199;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E3A;&#x6B62;&#xFF0C;&#x5C0F;&#x7A0B;&#x5E8F;&#x8FD8;&#x662F;&#x4E0D;&#x652F;&#x6301;async-await&#x8BED;&#x6CD5;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x4F7F;&#x7528;regenerator-runtime&#x8FD9;&#x4E2A;&#x5E93;</p><ol><li>&#x4E0B;&#x8F7D;regenerator-runtime&#x5E76;&#x653E;&#x5230;utils&#x76EE;&#x5F55;&#x4E0B;</li><li>&#x5728;util.js&#x5F15;&#x5165;<code>import regeneratorRuntime from &apos;./regenerator-runtime/runtime-module&apos;</code></li><li>&#x5C01;&#x88C5;wxRequest&#xFF0C;&#x8BA9;&#x5B83;&#x652F;&#x6301;async-await</li></ol><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="const wxRequest = async (url, params = {}) =&gt; {
  Object.assign(params, {
    token: wx.getStorageSync(&apos;token&apos;)
  })
  // &#x6240;&#x6709;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;header&#x9ED8;&#x8BA4;&#x643A;&#x5E26;token
  let header = params.header || {
    &apos;Content-Type&apos;: &apos;application/json&apos;,
    &apos;token&apos;: params.token || &apos;&apos;
  }
  let data = params.data || {}
  let method = params.method || &apos;GET&apos;
  // hideLoading&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x662F;&#x5426;&#x663E;&#x793A;&#x52A0;&#x8F7D;&#x72B6;&#x6001;
  if (!params.hideLoading) {
   wx.showLoading({
     title: &apos;&#x52A0;&#x8F7D;&#x4E2D;...&apos;,
   })
  }
  let res = await new Promise((resolve, reject) =&gt; {
    wx.request({
      url: url,
      method: method,
      data: data,
      header: header,
      success: (res) =&gt; {
        if (res &amp;&amp; res.statusCode == 200) {
          resolve(res.data)
        } else {
          reject(res)
        }
      },
      fail: (err) =&gt; {
        reject(err)
      },
      complete: (e) =&gt; {
        wx.hideLoading()
      }
    })
  })
  return res
}

export {
  wxRequest
}" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js"><span class="hljs-keyword">const</span> wxRequest = <span class="hljs-keyword">async</span> (url, params = {}) =&gt; {
  <span class="hljs-built_in">Object</span>.assign(params, {
    <span class="hljs-attr">token</span>: wx.getStorageSync(<span class="hljs-string">&apos;token&apos;</span>)
  })
  <span class="hljs-comment">// &#x6240;&#x6709;&#x7684;&#x8BF7;&#x6C42;&#xFF0C;header&#x9ED8;&#x8BA4;&#x643A;&#x5E26;token</span>
  <span class="hljs-keyword">let</span> header = params.header || {
    <span class="hljs-string">&apos;Content-Type&apos;</span>: <span class="hljs-string">&apos;application/json&apos;</span>,
    <span class="hljs-string">&apos;token&apos;</span>: params.token || <span class="hljs-string">&apos;&apos;</span>
  }
  <span class="hljs-keyword">let</span> data = params.data || {}
  <span class="hljs-keyword">let</span> method = params.method || <span class="hljs-string">&apos;GET&apos;</span>
  <span class="hljs-comment">// hideLoading&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x662F;&#x5426;&#x663E;&#x793A;&#x52A0;&#x8F7D;&#x72B6;&#x6001;</span>
  <span class="hljs-keyword">if</span> (!params.hideLoading) {
   wx.showLoading({
     <span class="hljs-attr">title</span>: <span class="hljs-string">&apos;&#x52A0;&#x8F7D;&#x4E2D;...&apos;</span>,
   })
  }
  <span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    wx.request({
      <span class="hljs-attr">url</span>: url,
      <span class="hljs-attr">method</span>: method,
      <span class="hljs-attr">data</span>: data,
      <span class="hljs-attr">header</span>: header,
      <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (res &amp;&amp; res.statusCode == <span class="hljs-number">200</span>) {
          resolve(res.data)
        } <span class="hljs-keyword">else</span> {
          reject(res)
        }
      },
      <span class="hljs-attr">fail</span>: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
        reject(err)
      },
      <span class="hljs-attr">complete</span>: <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
        wx.hideLoading()
      }
    })
  })
  <span class="hljs-keyword">return</span> res
}

<span class="hljs-keyword">export</span> {
  wxRequest
}</code></pre><p>&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="import regeneratorRuntime from &apos;../../utils/regenerator-runtime/runtime-module.js&apos;
import {
  wxRequest
} from &apos;../../utils/util.js&apos;

Page({
  data: {
   list:[],
   count: 0,
   page: 1,
   limit: 10
  },
  onLoad: function() {
    this.getList()
    // &#x8BF7;&#x6C42;&#x5DF2;&#x7ECF;&#x7ED3;&#x675F; &#x505A;&#x5176;&#x4ED6;&#x4E8B;
  },
  getList: async function() {
    await wxRequest(app.globalData.baseUrl + &apos;/test&apos;,{
      hideLoading: true,
      data: {
        limit: this.data.limit,
        page: this.data.page
      }
    }).then((ret) =&gt; {
      this.setData({
        list: ret.data.data,
        count: ret.data.num
      })
    })
  }
})" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js"><span class="hljs-keyword">import</span> regeneratorRuntime <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../utils/regenerator-runtime/runtime-module.js&apos;</span>
<span class="hljs-keyword">import</span> {
  wxRequest
} <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../utils/util.js&apos;</span>

Page({
  <span class="hljs-attr">data</span>: {
   <span class="hljs-attr">list</span>:[],
   <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
   <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
   <span class="hljs-attr">limit</span>: <span class="hljs-number">10</span>
  },
  <span class="hljs-attr">onLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.getList()
    <span class="hljs-comment">// &#x8BF7;&#x6C42;&#x5DF2;&#x7ECF;&#x7ED3;&#x675F; &#x505A;&#x5176;&#x4ED6;&#x4E8B;</span>
  },
  <span class="hljs-attr">getList</span>: <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">await</span> wxRequest(app.globalData.baseUrl + <span class="hljs-string">&apos;/test&apos;</span>,{
      <span class="hljs-attr">hideLoading</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">data</span>: {
        <span class="hljs-attr">limit</span>: <span class="hljs-keyword">this</span>.data.limit,
        <span class="hljs-attr">page</span>: <span class="hljs-keyword">this</span>.data.page
      }
    }).then(<span class="hljs-function">(<span class="hljs-params">ret</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.setData({
        <span class="hljs-attr">list</span>: ret.data.data,
        <span class="hljs-attr">count</span>: ret.data.num
      })
    })
  }
})</code></pre><p>&#x5C01;&#x88C5;&#x4E4B;&#x540E;&#x7528;&#x8D77;&#x6765;&#x8FD8;&#x662F;&#x5F88;&#x723D;&#x7684;&#xFF0C;&#x6269;&#x5C55;&#x8D77;&#x6765;&#x4E5F;&#x65B9;&#x4FBF;</p><h3 id="articleHeader5">&#x52A8;&#x6001;&#x8BBE;&#x7F6E;data&#x4E2D;&#x67D0;&#x4E2A;&#x503C;</h3><p>&#x5E94;&#x7528;&#x573A;&#x666F;&#xFF1A;&#x5FAA;&#x73AF;&#x51FA;&#x6765;&#x7684;&#x5217;&#x8868;&#xFF0C;&#x9700;&#x8981;&#x6839;&#x636E;&#x70B9;&#x51FB;&#x9879;&#xFF0C;&#x52A8;&#x6001;&#x6539;&#x53D8;&#x5217;&#x8868;&#x4E2D;&#x5BF9;&#x5E94;id&#x7684;&#x6570;&#x636E;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="// &#x52A8;&#x6001;&#x4F20;&#x9012;id
&lt;block wx:for=&quot;"{{"list"}}"&quot; wx:key=&quot;"{{"index"}}"&quot;&gt;
  &lt;view catch:tap=&quot;onChangeName&quot; data-id=&quot;"{{"item.id"}}"&quot;&gt;&lt;/view&gt;
&lt;/block&gt;

Page({
  data: {
    list:[{
      id: 0,
      name: &apos;wang&apos;
    },{
      id: 1,
      name: &apos;li&apos;
    }]
  },
  onChangeName: function(event){
    // &#x62FF;&#x5230;id
   let id = event.target.dataset.id
   let key = `list[${id}].name`, val = &apos;zhang&apos;
   // &#x8BBE;&#x7F6E;&#x503C;
   this.setData({
    [key]: val
   })
  }
})" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js"><span class="hljs-comment">// &#x52A8;&#x6001;&#x4F20;&#x9012;id</span>
&lt;block wx:<span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;"{{"list"}}"&quot;</span> wx:key=<span class="hljs-string">&quot;"{{"index"}}"&quot;</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">catch:tap</span>=<span class="hljs-string">&quot;onChangeName&quot;</span> <span class="hljs-attr">data-id</span>=<span class="hljs-string">&quot;"{{"item.id"}}"&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span>
&lt;<span class="hljs-regexp">/block&gt;

Page({
  data: {
    list:[{
      id: 0,
      name: &apos;wang&apos;
    },{
      id: 1,
      name: &apos;li&apos;
    }]
  },
  onChangeName: function(event){
    /</span><span class="hljs-regexp">/ &#x62FF;&#x5230;id
   let id = event.target.dataset.id
   let key = `list[${id}].name`, val = &apos;zhang&apos;
   /</span><span class="hljs-regexp">/ &#x8BBE;&#x7F6E;&#x503C;
   this.setData({
    [key]: val
   })
  }
})</span></code></pre><h3 id="articleHeader6">flex&#x5E03;&#x5C40;&#xFF0C;&#x6EA2;&#x51FA;&#x7701;&#x7565;&#x53F7;&#x65E0;&#x6548;</h3><p>&#x8BA2;&#x5355;&#x5217;&#x8868;&#x4E00;&#x822C;&#x90FD;&#x662F;&#x5DE6;&#x8FB9;&#x4E00;&#x4E2A;&#x56FE;&#x7247;&#xFF0C;&#x53F3;&#x8FB9;&#x662F;&#x6807;&#x9898;&#x6216;&#x63CF;&#x8FF0;&#x3002;&#x8FD9;&#x65F6;&#x5019;&#x56FE;&#x7247;&#x5BBD;&#x5EA6;&#x662F;&#x56FA;&#x5B9A;&#x7684;&#xFF0C;&#x6807;&#x9898;&#x957F;&#x5EA6;&#x81EA;&#x9002;&#x5E94;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text=".wrap {
  display: flex;
}
.sub {
  flex: 1;
  width: 0; // &#x5BBD;&#x5EA6;&#x8BBE;&#x4E3A;0
}
.sub text {
  display: block; // &#x4E00;&#x5B9A;&#x8981;&#x8BBE;&#x7F6E;&#x6210;block
}

&lt;view calss=&quot;wrap&quot;&gt;
  &lt;image src=&quot;i.png&quot;/&gt;
  &lt;view class=&quot;sub&quot;&gt;
    &lt;text&gt;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&lt;/text&gt;
    &lt;view&gt;&#x5176;&#x4ED6;&lt;/view&gt;
  &lt;/view&gt;
&lt;/view&gt;" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js">.wrap {
  <span class="hljs-attr">display</span>: flex;
}
.sub {
  <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>;
  width: <span class="hljs-number">0</span>; <span class="hljs-comment">// &#x5BBD;&#x5EA6;&#x8BBE;&#x4E3A;0</span>
}
.sub text {
  <span class="hljs-attr">display</span>: block; <span class="hljs-comment">// &#x4E00;&#x5B9A;&#x8981;&#x8BBE;&#x7F6E;&#x6210;block</span>
}

&lt;view calss=<span class="hljs-string">&quot;wrap&quot;</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;i.png&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sub&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">text</span>&gt;</span>&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;&#x4E00;&#x6BB5;&#x6587;&#x672C;<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>&#x5176;&#x4ED6;<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span></code></pre><h3 id="articleHeader7">&#x7EC4;&#x4EF6;&#x4E8B;&#x4EF6;&#x4F20;&#x9012;</h3><p>&#x4EFB;&#x52A1;&#xFF1A;&#x7236;&#x7EC4;&#x4EF6;&#x5411;&#x5B50;&#x7EC4;&#x4EF6;&#x4F20;&#x9012;&#x521D;&#x59CB;&#x6570;&#x636E;&#xFF0C;&#x5F53;&#x5B50;&#x7EC4;&#x4EF6;&#x70B9;&#x51FB;&#x4EE5;&#x540E;&#x53EF;&#x4EE5;triggerEvent&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;&#xFF0C;&#x7236;&#x7EC4;&#x4EF6;&#x6267;&#x884C;&#x81EA;&#x5B9A;&#x4E49;&#x4E8B;&#x4EF6;&#xFF0C;&#x91CD;&#x65B0;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#x5E76;&#x4F20;&#x7ED9;&#x5B50;&#x7EC4;&#x4EF6;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="/* &#x5B50;&#x7EC4;&#x4EF6; */
&lt;view&gt;
  &lt;view bind:tap=&quot;setId&quot; data-id=&quot;1&quot;&gt;&lt;/view&gt;
&lt;/view&gt;

properties: {
  list: {
    type: Array,
    default: []
  }
},

methods: {
  setId(e) {
    let id = e.currentTarget.dataset.id
    this.triggerEvent(&apos;deleteFav&apos;, id)
  }
}

/* &#x7236;&#x9875;&#x9762; */
&lt;child bind:customEvent=&quot;deleteFav&quot;&gt;&lt;/child&gt;

data: {
  list: []
},
deleteFav(e) {
  let id = e.detail // &#x83B7;&#x53D6;&#x4F20;&#x9012;&#x8FC7;&#x6765;&#x7684;&#x6570;&#x636E;
  // &#x6839;&#x636E;id&#x8BF7;&#x6C42;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x65B0;setData
  let newData = [1,2,3]
  this.setData({
    list: newData
  })
}" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js"><span class="hljs-comment">/* &#x5B50;&#x7EC4;&#x4EF6; */</span>
&lt;view&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">bind:tap</span>=<span class="hljs-string">&quot;setId&quot;</span> <span class="hljs-attr">data-id</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></span>
&lt;<span class="hljs-regexp">/view&gt;

properties: {
  list: {
    type: Array,
    default: []
  }
},

methods: {
  setId(e) {
    let id = e.currentTarget.dataset.id
    this.triggerEvent(&apos;deleteFav&apos;, id)
  }
}

/</span>* &#x7236;&#x9875;&#x9762; *<span class="hljs-regexp">/
&lt;child bind:customEvent=&quot;deleteFav&quot;&gt;&lt;/</span>child&gt;

data: {
  <span class="hljs-attr">list</span>: []
},
deleteFav(e) {
  <span class="hljs-keyword">let</span> id = e.detail <span class="hljs-comment">// &#x83B7;&#x53D6;&#x4F20;&#x9012;&#x8FC7;&#x6765;&#x7684;&#x6570;&#x636E;</span>
  <span class="hljs-comment">// &#x6839;&#x636E;id&#x8BF7;&#x6C42;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x65B0;setData</span>
  <span class="hljs-keyword">let</span> newData = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
  <span class="hljs-keyword">this</span>.setData({
    <span class="hljs-attr">list</span>: newData
  })
}</code></pre><h3 id="articleHeader8">&#x4F7F;&#x7528;wxParse&#x89E3;&#x6790;HTML</h3><ol><li>&#x4E0B;&#x8F7D;<a href="https://github.com/icindy/wxParse" rel="nofollow noreferrer" target="_blank">wxParse</a>&#xFF0C;&#x653E;&#x5230;utils&#x76EE;&#x5F55;&#x4E0B;</li><li>&#x5728;JS&#x9875;&#x9762;&#x5F15;&#x5165;&#xFF1A;<code>import WxParse from &apos;../../utils/wxParse/wxParse&apos;</code></li></ol><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="Page({
  data:{
    contentHTML:&apos;&apos; // &#x89E3;&#x6790;&#x540E;&#x7684;HTML
  },
  onLoad: function() {
    // &#x8BF7;&#x6C42;&#x5230;&#x7684;HTML&#x6570;&#x636E;
    let content = &apos;&lt;div&gt;&#x6211;&#x662F;HTML&#x4EE3;&#x7801;&lt;/div&gt;&apos;, that = this;
    WxParse.wxParse(&apos;contentHTML&apos;, &apos;html&apos;, content, that, 0);
  }
})
" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js">Page({
  <span class="hljs-attr">data</span>:{
    <span class="hljs-attr">contentHTML</span>:<span class="hljs-string">&apos;&apos;</span> <span class="hljs-comment">// &#x89E3;&#x6790;&#x540E;&#x7684;HTML</span>
  },
  <span class="hljs-attr">onLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// &#x8BF7;&#x6C42;&#x5230;&#x7684;HTML&#x6570;&#x636E;</span>
    <span class="hljs-keyword">let</span> content = <span class="hljs-string">&apos;&lt;div&gt;&#x6211;&#x662F;HTML&#x4EE3;&#x7801;&lt;/div&gt;&apos;</span>, that = <span class="hljs-keyword">this</span>;
    WxParse.wxParse(<span class="hljs-string">&apos;contentHTML&apos;</span>, <span class="hljs-string">&apos;html&apos;</span>, content, that, <span class="hljs-number">0</span>);
  }
})
</code></pre><ol><li>&#x663E;&#x793A;&#x89E3;&#x6790;&#x5185;&#x5BB9;</li></ol><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="&lt;import src=&quot;../../utils/wxParse/wxParse.wxml&quot;/&gt;
&lt;view&gt;
  &lt;!-- &#x663E;&#x793A;&#x5185;&#x5BB9; --&gt;
  &lt;template is=&quot;wxParse&quot; data=&quot;"{{"wxParseData:contentHTML.nodes"}}"&quot; /&gt;
&lt;/view&gt;" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="xml hljs"><code class="html"><span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../../utils/wxParse/wxParse.wxml&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- &#x663E;&#x793A;&#x5185;&#x5BB9; --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">is</span>=<span class="hljs-string">&quot;wxParse&quot;</span> <span class="hljs-attr">data</span>=<span class="hljs-string">&quot;"{{"wxParseData:contentHTML.nodes"}}"&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span></code></pre><h3 id="articleHeader9">&#x56FE;&#x7247;&#x7B49;&#x6BD4;&#x4F8B;</h3><p>image&#x6807;&#x7B7E;&#x6709;&#x4E2A;mode&#x5C5E;&#x6027;&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x56FE;&#x7247;&#x5982;&#x4F55;&#x663E;&#x793A;&#xFF0C;&#x5982;&#x679C;&#x6587;&#x6863;&#x770B;&#x7684;&#x4E0D;&#x4ED4;&#x7EC6;&#x8FD8;&#x771F;&#x5BB9;&#x6613;&#x53D1;&#x73B0;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="&lt;image src=&quot;test.png&quot; mode=&quot;widthFix&quot;/&gt;" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="xml hljs"><code class="html" style="word-break:break-word;white-space:initial"><span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;test.png&quot;</span> <span class="hljs-attr">mode</span>=<span class="hljs-string">&quot;widthFix&quot;</span>/&gt;</span></code></pre><h3 id="articleHeader10">&#x4E0A;&#x62C9;&#x52A0;&#x8F7D;&#x548C;&#x4E0B;&#x62C9;&#x5237;&#x65B0;</h3><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="{
  &quot;onReachBottomDistance&quot;: 0,
  &quot;enablePullDownRefresh&quot;: true
}" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="json hljs"><code class="json">{
  <span class="hljs-attr">&quot;onReachBottomDistance&quot;</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">&quot;enablePullDownRefresh&quot;</span>: <span class="hljs-literal">true</span>
}</code></pre><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="data: {
  limit: 30,
  page: 1,
  list:[],
  count:0
},
// &#x4E0B;&#x62C9;
onPullDownRefresh: function () {
  this.setData({
    page: 1,
    list:[]
  })
  this.getData()
  wx.stopPullDownRefresh()
},
// &#x4E0A;&#x62C9;
onReachBottom: function () {
  if(this.data.list.length &gt;= this.data.count) {
    return false
  }
  this.setData({
    page: this.data.page + 1
  })
  this.getData()
},
getData: async function () {
  await wxRequest(app.globalData.baseUrl + &apos;/test&apos;, {
    data: {
      page: this.data.page,
      limit: this.data.limit,
    }
  }).then((ret) =&gt; {
    let list = this.data.list.concat(ret.data.list)
    this.setData({
      list: list,
      count: ret.data.count
    })
  })
}" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js">data: {
  <span class="hljs-attr">limit</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">list</span>:[],
  <span class="hljs-attr">count</span>:<span class="hljs-number">0</span>
},
<span class="hljs-comment">// &#x4E0B;&#x62C9;</span>
onPullDownRefresh: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.setData({
    <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">list</span>:[]
  })
  <span class="hljs-keyword">this</span>.getData()
  wx.stopPullDownRefresh()
},
<span class="hljs-comment">// &#x4E0A;&#x62C9;</span>
onReachBottom: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.data.list.length &gt;= <span class="hljs-keyword">this</span>.data.count) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }
  <span class="hljs-keyword">this</span>.setData({
    <span class="hljs-attr">page</span>: <span class="hljs-keyword">this</span>.data.page + <span class="hljs-number">1</span>
  })
  <span class="hljs-keyword">this</span>.getData()
},
<span class="hljs-attr">getData</span>: <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">await</span> wxRequest(app.globalData.baseUrl + <span class="hljs-string">&apos;/test&apos;</span>, {
    <span class="hljs-attr">data</span>: {
      <span class="hljs-attr">page</span>: <span class="hljs-keyword">this</span>.data.page,
      <span class="hljs-attr">limit</span>: <span class="hljs-keyword">this</span>.data.limit,
    }
  }).then(<span class="hljs-function">(<span class="hljs-params">ret</span>) =&gt;</span> {
    <span class="hljs-keyword">let</span> list = <span class="hljs-keyword">this</span>.data.list.concat(ret.data.list)
    <span class="hljs-keyword">this</span>.setData({
      <span class="hljs-attr">list</span>: list,
      <span class="hljs-attr">count</span>: ret.data.count
    })
  })
}</code></pre><h3 id="articleHeader11">&#x4E0A;&#x4F20;&#x56FE;&#x7247;</h3><p>&#x4EFB;&#x52A1;&#xFF1A;&#x5C0F;&#x7A0B;&#x5E8F;&#x4E0A;&#x4F20;&#x56FE;&#x7247;&#x5230;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6700;&#x591A;&#x4E0A;&#x4F20;&#x4E09;&#x5F20;&#xFF0C;&#x524D;&#x7AEF;&#x53EF;&#x4EE5;&#x5220;&#x9664;&#x56FE;&#x7247;</p><p>&#x6548;&#x679C;&#x56FE;&#x5982;&#x4E0B;</p><p><span class="img-wrap"><img data-src="https://user-gold-cdn.xitu.io/2018/7/18/164acd46e0c5058f?w=366&amp;h=174&amp;f=png&amp;s=27051" src="https://static.alili.techhttps://user-gold-cdn.xitu.io/2018/7/18/164acd46e0c5058f?w=366&amp;h=174&amp;f=png&amp;s=27051" alt="" title="" style="cursor:pointer"></span></p><p>&#x4F7F;&#x7528;&#x5230;&#x7684;API&#x6709;&#x4E24;&#x4E2A;&#xFF1A;wx.uploadFile wx.chooseImage</p><p>&#x793A;&#x4F8B;WXML&#xFF1A;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="&lt;view class=&quot;sale after-pic&quot;&gt;
  &lt;block wx:for=&quot;"{{"imgList"}}"&quot; wx:key=&quot;"{{"index"}}"&quot;&gt;
    &lt;view class=&quot;pic&quot;&gt;
      &lt;image src=&quot;"{{"item"}}"&quot; /&gt;
      &lt;icon type=&quot;clear&quot; size=&quot;20&quot; catchtap=&quot;clearImg&quot; data-id=&quot;"{{"index"}}"&quot;/&gt;
    &lt;/view&gt;
  &lt;/block&gt;
  &lt;image src=&quot;../../images/upload.png&quot; catchtap=&quot;chooseImage&quot; /&gt;
&lt;/view&gt;
&lt;button catchtap=&quot;onSub&quot;&gt;&#x63D0;&#x4EA4;&lt;/button&gt;" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="xml hljs"><code class="html"><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sale after-pic&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">block</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">&quot;"{{"imgList"}}"&quot;</span> <span class="hljs-attr">wx:key</span>=<span class="hljs-string">&quot;"{{"index"}}"&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pic&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;"{{"item"}}"&quot;</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">icon</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;clear&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;20&quot;</span> <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;clearImg&quot;</span> <span class="hljs-attr">data-id</span>=<span class="hljs-string">&quot;"{{"index"}}"&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">block</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../../images/upload.png&quot;</span> <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;chooseImage&quot;</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">catchtap</span>=<span class="hljs-string">&quot;onSub&quot;</span>&gt;</span>&#x63D0;&#x4EA4;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></code></pre><p>imgList&#x662F;wx.chooseImage&#x6210;&#x529F;&#x540E;&#x8FD4;&#x56DE;&#x7684;&#x56FE;&#x7247;&#x4E34;&#x65F6;&#x5730;&#x5740;</p><p>&#x793A;&#x4F8B;JS</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="Page({
  data: {
    imgList:[]
  },
  // &#x4F7F;&#x7528;async await&#x662F;&#x56E0;&#x4E3A;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x662F;&#x5F02;&#x6B65;&#x7684;
  onSub: async function() {
    // &#x70B9;&#x51FB;&#x63D0;&#x4EA4;&#x540E;&#xFF0C;&#x5F00;&#x59CB;&#x4E0A;&#x4F20;&#x56FE;&#x7247;
     let imgUrls = []
     for (let index = 0; index &lt; this.data.imgList.length; index++) {
       await this.uploadFile(this.data.imgList[index]).then((res) =&gt; {
         // &#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;&#x628A;res.data parse&#x4E00;&#x4E0B;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x5B57;&#x7B26;&#x4E32;
         let parseData = JSON.parse(res.data)
         imgUrls.push(parseData.data) // &#x56FE;&#x7247;&#x5730;&#x5740;
       })
     }
     console.log(imgUrls) // 3&#x5F20;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#x540E;&#xFF0C;&#x6267;&#x884C;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;
  },
  // &#x5220;&#x9664;&#x67D0;&#x5F20;&#x56FE;&#x7247;
  clearImg: function (params) {
    let imgList = this.data.imgList
    let id = params.currentTarget.dataset.id // &#x56FE;&#x7247;&#x7D22;&#x5F15;
    imgList.splice(id, 1) // &#x5220;&#x9664;
    this.setData({
      imgList: imgList
    })
  },
  chooseImage: function (params) {
    wx.chooseImage({
      count: 3, // &#x505A;&#x591A;3&#x5F20;
      sizeType: [&apos;original&apos;, &apos;compressed&apos;],
      sourceType: [&apos;album&apos;, &apos;camera&apos;],
      success: (res) =&gt; {
        // &#x5B58;&#x50A8;&#x4E34;&#x65F6;&#x5730;&#x5740;
        this.setData({
          imgList: res.tempFilePaths
        })
      }
    })
  },
  uploadFile: function (filePath) {
    // &#x8FD4;&#x56DE;Promise&#x662F;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x7684;&#x5F02;&#x6B65;&#x95EE;&#x9898;
    return new Promise( (resolve, reject) =&gt; {
      wx.uploadFile({
        url: app.globalData.baseUrl + &apos;/file/upload&apos;, // &#x4E0A;&#x4F20;&#x5730;&#x5740;
        filePath: filePath,
        name: &apos;file&apos;, // &#x8FD9;&#x91CC;&#x7684;&#x5177;&#x4F53;&#x503C;&#xFF0C;&#x95EE;&#x540E;&#x7AEF;&#x4EBA;&#x5458;
        formData: {},
        header: {
          &quot;Content-Type&quot;: &quot;multipart/form-data&quot;
        },
        success: (res) =&gt; {
           resolve(res)
         },
         fail: (err) =&gt; {
           reject(err)
           console.log(err)
         }
      })
    })
  }
})" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js">Page({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">imgList</span>:[]
  },
  <span class="hljs-comment">// &#x4F7F;&#x7528;async await&#x662F;&#x56E0;&#x4E3A;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x662F;&#x5F02;&#x6B65;&#x7684;</span>
  onSub: <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// &#x70B9;&#x51FB;&#x63D0;&#x4EA4;&#x540E;&#xFF0C;&#x5F00;&#x59CB;&#x4E0A;&#x4F20;&#x56FE;&#x7247;</span>
     <span class="hljs-keyword">let</span> imgUrls = []
     <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; <span class="hljs-keyword">this</span>.data.imgList.length; index++) {
       <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.uploadFile(<span class="hljs-keyword">this</span>.data.imgList[index]).then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
         <span class="hljs-comment">// &#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;&#x628A;res.data parse&#x4E00;&#x4E0B;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x5B57;&#x7B26;&#x4E32;</span>
         <span class="hljs-keyword">let</span> parseData = <span class="hljs-built_in">JSON</span>.parse(res.data)
         imgUrls.push(parseData.data) <span class="hljs-comment">// &#x56FE;&#x7247;&#x5730;&#x5740;</span>
       })
     }
     <span class="hljs-built_in">console</span>.log(imgUrls) <span class="hljs-comment">// 3&#x5F20;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x6210;&#x529F;&#x540E;&#xFF0C;&#x6267;&#x884C;&#x5176;&#x4ED6;&#x64CD;&#x4F5C;</span>
  },
  <span class="hljs-comment">// &#x5220;&#x9664;&#x67D0;&#x5F20;&#x56FE;&#x7247;</span>
  clearImg: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">params</span>) </span>{
    <span class="hljs-keyword">let</span> imgList = <span class="hljs-keyword">this</span>.data.imgList
    <span class="hljs-keyword">let</span> id = params.currentTarget.dataset.id <span class="hljs-comment">// &#x56FE;&#x7247;&#x7D22;&#x5F15;</span>
    imgList.splice(id, <span class="hljs-number">1</span>) <span class="hljs-comment">// &#x5220;&#x9664;</span>
    <span class="hljs-keyword">this</span>.setData({
      <span class="hljs-attr">imgList</span>: imgList
    })
  },
  <span class="hljs-attr">chooseImage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">params</span>) </span>{
    wx.chooseImage({
      <span class="hljs-attr">count</span>: <span class="hljs-number">3</span>, <span class="hljs-comment">// &#x505A;&#x591A;3&#x5F20;</span>
      sizeType: [<span class="hljs-string">&apos;original&apos;</span>, <span class="hljs-string">&apos;compressed&apos;</span>],
      <span class="hljs-attr">sourceType</span>: [<span class="hljs-string">&apos;album&apos;</span>, <span class="hljs-string">&apos;camera&apos;</span>],
      <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
        <span class="hljs-comment">// &#x5B58;&#x50A8;&#x4E34;&#x65F6;&#x5730;&#x5740;</span>
        <span class="hljs-keyword">this</span>.setData({
          <span class="hljs-attr">imgList</span>: res.tempFilePaths
        })
      }
    })
  },
  <span class="hljs-attr">uploadFile</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">filePath</span>) </span>{
    <span class="hljs-comment">// &#x8FD4;&#x56DE;Promise&#x662F;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x7684;&#x5F02;&#x6B65;&#x95EE;&#x9898;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>( <span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      wx.uploadFile({
        <span class="hljs-attr">url</span>: app.globalData.baseUrl + <span class="hljs-string">&apos;/file/upload&apos;</span>, <span class="hljs-comment">// &#x4E0A;&#x4F20;&#x5730;&#x5740;</span>
        filePath: filePath,
        <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;file&apos;</span>, <span class="hljs-comment">// &#x8FD9;&#x91CC;&#x7684;&#x5177;&#x4F53;&#x503C;&#xFF0C;&#x95EE;&#x540E;&#x7AEF;&#x4EBA;&#x5458;</span>
        formData: {},
        <span class="hljs-attr">header</span>: {
          <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;multipart/form-data&quot;</span>
        },
        <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
           resolve(res)
         },
         <span class="hljs-attr">fail</span>: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
           reject(err)
           <span class="hljs-built_in">console</span>.log(err)
         }
      })
    })
  }
})</code></pre><h3 id="articleHeader12">&#x52A8;&#x6001;&#x6807;&#x9898;</h3><p>onLoad&#x7684;&#x65F6;&#x5019;&#x52A8;&#x6001;&#x8BBE;&#x7F6E;&#x6807;&#x9898;</p><div class="widget-codetool" style="display:none"><div class="widget-codetool--inner"><span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x5168;&#x9009;"></span> <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="wx.setNavigationBarTitle({
  title: &apos;&#x65B0;&#x6807;&#x9898;&apos;
})" title="" data-original-title="&#x590D;&#x5236;"></span> <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="&#x653E;&#x8FDB;&#x7B14;&#x8BB0;"></span></div></div><pre class="javascript hljs"><code class="js">wx.setNavigationBarTitle({
  <span class="hljs-attr">title</span>: <span class="hljs-string">&apos;&#x65B0;&#x6807;&#x9898;&apos;</span>
})</code></pre><h3 id="articleHeader13">&#x7ED3;&#x8BED;</h3><p>&#x4EE5;&#x4E0A;&#x662F;&#x4EC5;&#x4E3A;&#x6211;&#x4E2A;&#x4EBA;&#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x95EE;&#x9898;&#xFF0C;&#x82E5;&#x6709;&#x9519;&#x8BEF;&#x8FD8;&#x8BF7;&#x6279;&#x8BC4;&#x6307;&#x6B63;&#xFF0C;&#x611F;&#x8C22;&#x9605;&#x8BFB;</p>
{{< /raw >}}

# 版权声明
本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，

本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。

原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！

## 原文标题
小程序开发技巧总结

## 原文链接
[https://segmentfault.com/a/1190000015682251](https://segmentfault.com/a/1190000015682251)

