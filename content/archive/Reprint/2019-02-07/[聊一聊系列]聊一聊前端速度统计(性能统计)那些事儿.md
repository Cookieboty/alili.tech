---
title: '[聊一聊系列]聊一聊前端速度统计(性能统计)那些事儿' 
date: 2019-02-07 2:30:16
hidden: true
slug: bnj4hbgqdl
categories: [reprint]
---

{{< raw >}}

                    
<p>欢迎大家收看聊一聊系列，这一套系列文章，可以帮助前端工程师们了解前端的方方面面（不仅仅是代码）：</p>
<p><a href="https://segmentfault.com/blog/frontenddriver">https://segmentfault.com/blog/frontenddriver</a></p>
<p>上一篇文章我们讨论了，如何进行前端日志打点统计：</p>
<p><a href="https://segmentfault.com/a/1190000005861012" target="_blank">https://segmentfault.com/a/1190000005861012</a></p>
<p>这一篇我们来看看如何进行速度统计</p>
<p>网站的速度影响了用户访问网站最初的体验。试想，如果一个用户，在等待了若干秒后，还是停留在白屏的状态，那么他的选择将是离开这个网站。性能统计有助于帮我们检测网站的用户体验。</p>
<p>这里引用百度百科中的一句话 ----&nbsp;通常一个网站，如果首屏时间在2秒以内是比较优秀的，5秒以内是可以接受的，5秒以上就不可容忍了。用户会选择刷新页面或立刻离开。</p>
<p>这里，有些数据需要与大家分享一下(来自FEX的统计)：</p>
<table>
<thead><tr>
<th>产品</th>
<th align="left">性能</th>
<th align="left">收益</th>
</tr></thead>
<tbody>
<tr>
<td>Google</td>
<td align="left">延迟&nbsp;400ms</td>
<td align="left">搜索量下降&nbsp;0.59%</td>
</tr>
<tr>
<td>Bing</td>
<td align="left">延迟&nbsp;2s</td>
<td align="left">收入下降&nbsp;4.3%</td>
</tr>
<tr>
<td>Yahoo</td>
<td align="left">延迟&nbsp;400ms</td>
<td align="left">流量下降&nbsp;5-9%</td>
</tr>
<tr>
<td>Mozilla</td>
<td align="left">页面打开减少&nbsp;2.2s</td>
<td align="left">下载量提升&nbsp;15.4%</td>
</tr>
<tr>
<td>Netflix</td>
<td align="left">开启 Gzip性能提升 13.25%</td>
<td align="left">带宽减少50%</td>
</tr>
</tbody>
</table>
<p>可以看到，速度，对于一个网站来说，重要性可见一斑。</p>
<h2 id="articleHeader0">1、网站都有哪些指标？</h2>
<h3 id="articleHeader1">1.1 首屏时间</h3>
<hr>
<p>这个指标对于大多数网站来说，非常重要。那么何为首屏时间呢？引用百度百科里的一句话，就是:</p>
<p>网站用户体验的一个重要指标。　指一个网站被浏览器如IE窗口上部800*600的区域被充满所需时间。</p>
<p>其实就是你的网页刚进入时，渲染完整个浏览器屏幕的时间。</p>
<p>关于是否包含首屏所有的图片下载完成。这个网上有些争议，有的同学说不包含图片，只要DOM+样式 都渲染完了，就算完成了。</p>
<p>笔者认为，既然是首屏，那么首屏上所有的东西都加载完成，让用户感受不到还有没完成的部分，就算完成了。</p>
<p>所以，综合一下，咱们的首屏时间，包括首屏的DOM元素的渲染，展现在用户第一屏幕的所有图片都完成。</p>
<p>其实Chrome提供开发着检查网站整个渲染过程的小公举，哦不，是小工具（如图1.1.1所示）在F12开发者工具的Network面板里面：</p>
<p><span class="img-wrap"><img data-src="/img/bVyNcN" src="https://static.alili.tech/img/bVyNcN" alt="图片描述" title="图片描述" style="cursor: pointer;"></span><br>图1.1.1</p>
<p>这个是屏幕捕获的工具，可以看到整个网页的渲染过程。我们接着来深究一下上述哪个时间点是首屏时间点。</p>
<p>我们来一起看看百度首页的首屏情况，由于百度首页加载比较快，所以这里咱们模拟一下3G网的延迟（如图1.1.2）：<br><span class="img-wrap"><img data-src="/img/bVyM7j" src="https://static.alili.tech/img/bVyM7j" alt="图片描述" title="图片描述" style="cursor: pointer;"></span><br>图1.1.2</p>
<p>我们看到，虽然在240ms的时候，网页算是被渲染出来了，但是还是有很多空白的地方。</p>
<p>279MS的时候，虽然框架都被渲染完成了，DOM与样式也都渲染完成了，但是我们看到图片还不完整，所以，当然也不算首屏完成了。</p>
<p>有的同学会说，318ms的时候，总算完成了吧，nonono，我们向后观察，就会发现还有一些元素会再被渲染出来。也就是说知道稳定之前，我们都不能算首屏完成了。</p>
<p>知道487 ms的时候，页面才算加载完成了。并且之后不会再发生页面的抖动了。</p>
<p>看完这些，相信聪明的你心里已经有数了，什么是首屏时间。</p>
<h3 id="articleHeader2">1.2 白屏时间</h3>
<p>&nbsp; &nbsp; 这个其实不多说，读者也明白，就是页面处于空白的时间。页面空白，用户就会焦躁，并且变得不耐心。影响白屏时间的多数是：DNS解析耗时+服务端耗时+网络传输耗时。</p>
<h3 id="articleHeader3">1.3&nbsp;用户可操作时间</h3>
<p>&nbsp; &nbsp; 顾名思义，这项指标值得是，我们的网页用户可以使用的时间。一般来讲 domready时间，便是我们的用户可操作时间了。</p>
<h3 id="articleHeader4">1.4 总下载时间</h3>
<p>&nbsp; &nbsp; 通常指，页面总体的下载时间，所有的页面资源都下载完成。</p>
<h3 id="articleHeader5">1.5 自定义指标</h3>
<p>&nbsp; &nbsp; 由于业务不同，站长们所关心的时间必然也不同了。比如你可能是一个电商网站的站长，你关心你的第一屏商品到底展示的有多快( 通常这会带来更多的收入)，所以，你需要监控你的商品展现的时间。</p>
<h2 id="articleHeader6">2 如何统计自己网站的这些指标</h2>
<p>如果并不想要花费精力在这些统计上，只是要小小的关注一下的话，当然可以自己打开控制台，在页面的各个阶段，将时间打印出来，亦或者是使用html5新增的接口：performance来评估一下自己的网站到底差在哪里(如图2.0.1)。<br><span class="img-wrap"><img data-src="/img/bVyM7E" src="https://static.alili.tech/img/bVyM7E" alt="145325_AOW5_1177792.png" title="145325_AOW5_1177792.png" style="cursor: pointer;"></span><br>图2.0.1</p>
<p>但是，你的测试并不能代表所有的用户的情况。而且，你需要一个监控程序，去时刻提醒着你，现在你的网站的速度处于什么状况。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;所以，对于有追求一些的站长而言，笔者在这里更建议采用用户日志，即，在自己网站的代码中，增加统计，并把统计结果发送到服务器。在服务器采集这些日志，并产生一个监控的网站。其实大可不必使用一些付费的服务，我们自己就可以轻轻松松的做一个简答的速度监控服务。</p>
<p>&nbsp; &nbsp; 在本文的第三节，我们将会一起做一个小的速度监控服务的例子。很多站长甚至可以拿过来直接使用。接下来，我们还是针对之前我们提到过的几个指标，注意讲解统计方法：</p>
<h3 id="articleHeader7">2.1 如何统计首屏时间</h3>
<p>&nbsp; &nbsp;&nbsp;其实，对于网页高度小于屏幕的网站来说，统计首屏时间非常的简单，只要在页面底部加上脚本打印当前时间即可，或者对于网页高度大于一屏的网页来说，只要在估算接近于一屏幕的元素的位置后，打印一下当前时间即可。</p>
<p>&nbsp; &nbsp; 比如，现在你有一个简单的网页（如图2.1.1所示）：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="<!DOCTYPE html>
<html>
    <head>
        <meta charset=&quot;utf-8&quot;>
        <meta name=&quot;viewport&quot; content=&quot;width=device-width,minimum-scale=1.0,maximum-scale=1.0&quot;>
    </head>
    <body>
        <div>这是第一屏，这是第一屏</div>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <div>第一屏结尾，第一屏结尾</div>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
    </body>
</html>
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs xml"><code><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,minimum-scale=1.0,maximum-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>这是第一屏，这是第一屏<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>第一屏结尾，第一屏结尾<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><span class="img-wrap"><img data-src="/img/bVyM9P" src="https://static.alili.tech/img/bVyM9P" alt="152854_WBnH_1177792.png" title="152854_WBnH_1177792.png" style="cursor: pointer; display: inline;"></span><br>图2.1.1</p>
<p>我们需要统计首屏时间的话，则需要定义一个基准，就是--什么时候用户点开的当前网页，HTML5的performance接口提供了这个时间：performance.timing.navigationStart，这个就是用户访问我们网页最开始的跳转时间了。</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="<head>
    <script type=&quot;text/javascript&quot;>
        window.logInfo = {};
        window.logInfo.openTime = performance.timing.navigationStart;
    </script>
</head>
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs dust"><code><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
        <span class="hljs-built_in">window</span>.logInfo = </span></span><span class="hljs-template-variable">{}</span><span class="xml"><span class="javascript">;
        <span class="hljs-built_in">window</span>.logInfo.openTime = performance.timing.navigationStart;
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
</span></code></pre>
<p>我们在页面开头处，将基准记下。</p>
<p>接下来，在大约的首屏处加上我们的统计：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="<div>第一屏结尾，第一屏结尾</div>
<script type=&quot;text/javascript&quot;>
    window.logInfo.firstScreen = +new Date() - window.logInfo.openTime;
    console.log('首屏时间：', window.logInfo.firstScreen + 'ms');
</script>
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs xml"><code><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>第一屏结尾，第一屏结尾<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="hljs-built_in">window</span>.logInfo.firstScreen = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'首屏时间：'</span>, <span class="hljs-built_in">window</span>.logInfo.firstScreen + <span class="hljs-string">'ms'</span>);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>我们再来看看我们的页面(如图2.1.2所示)：<br><span class="img-wrap"><img data-src="/img/bVyM9R" src="https://static.alili.tech/img/bVyM9R" alt="154049_1pEB_1177792.png" title="154049_1pEB_1177792.png" style="cursor: pointer;"></span><br>图2.1.2</p>
<p>便有了首屏时间。</p>
<p>霸特，霸特。同学们不要激动的太早。我们这个首屏时间，并不没有算上图片。所以，我们得把首屏中所有图片的加载时间也算上。</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="<!DOCTYPE html>
<html>
    <head>
        <meta charset=&quot;utf-8&quot;>
        <meta name=&quot;viewport&quot; content=&quot;width=device-width,minimum-scale=1.0,maximum-scale=1.0&quot;>
        <script type=&quot;text/javascript&quot;>
            window.logInfo = {};
            window.logInfo.openTime = performance.timing.navigationStart;
        </script>
    </head>
    <body>
        <div>这是第一屏，这是第一屏</div>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <div>第一屏结尾，第一屏结尾</div>
        <script type=&quot;text/javascript&quot;>
            (function logFirstScreen() {
                var images = document.getElementsByTagName('img');
                var iLen = images.length;
                var curMax = 0;
                var inScreenLen = 0;
                // 图片的加载回调
                function imageBack() {
                    this.removeEventListener
                    &amp;&amp; this.removeEventListener('load', imageBack, !1);
                    if (++curMax === inScreenLen) {
                        // 如果所有在首屏的图片均已加载完成了的话，发送日志
                        log();
                    }   
                }   
                // 对于所有的位于指定区域的图片，绑定回调事件
                for (var s = 0; s < iLen; s++) {
                    var img = images[s];
                    var offset = {
                        top: 0
                    };
                    var curImg = img;
                    while (curImg.offsetParent) {
                        offset.top += curImg.offsetTop;
                        curImg = curImg.offsetParent;
                    }
                    // 判断图片在不在首屏
                    if (document.documentElement.clientHeight < offset.top) {
                        continue;
                    }
                    // 图片还没有加载完成的话
                    if (!img.complete) {
                        inScreenLen++;
                        img.addEventListener('load', imageBack, !1);
                    }
                }
                // 如果首屏没有图片的话，直接发送日志
                if (inScreenLen === 0) {
                    log();
                }
                // 发送日志进行统计
                function log () {
                    window.logInfo.firstScreen = +new Date() - window.logInfo.openTime;
                    console.log('首屏时间：', window.logInfo.firstScreen + 'ms');
                }
            })();
        </script>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
    </body>
</html>
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs xml"><code><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,minimum-scale=1.0,maximum-scale=1.0"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
            <span class="hljs-built_in">window</span>.logInfo = {};
            <span class="hljs-built_in">window</span>.logInfo.openTime = performance.timing.navigationStart;
        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>这是第一屏，这是第一屏<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>第一屏结尾，第一屏结尾<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
            (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logFirstScreen</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">var</span> images = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'img'</span>);
                <span class="hljs-keyword">var</span> iLen = images.length;
                <span class="hljs-keyword">var</span> curMax = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">var</span> inScreenLen = <span class="hljs-number">0</span>;
                <span class="hljs-comment">// 图片的加载回调</span>
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">imageBack</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">this</span>.removeEventListener
                    &amp;&amp; <span class="hljs-keyword">this</span>.removeEventListener(<span class="hljs-string">'load'</span>, imageBack, !<span class="hljs-number">1</span>);
                    <span class="hljs-keyword">if</span> (++curMax === inScreenLen) {
                        <span class="hljs-comment">// 如果所有在首屏的图片均已加载完成了的话，发送日志</span>
                        log();
                    }   
                }   
                <span class="hljs-comment">// 对于所有的位于指定区域的图片，绑定回调事件</span>
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> s = <span class="hljs-number">0</span>; s &lt; iLen; s++) {
                    <span class="hljs-keyword">var</span> img = images[s];
                    <span class="hljs-keyword">var</span> offset = {
                        <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>
                    };
                    <span class="hljs-keyword">var</span> curImg = img;
                    <span class="hljs-keyword">while</span> (curImg.offsetParent) {
                        offset.top += curImg.offsetTop;
                        curImg = curImg.offsetParent;
                    }
                    <span class="hljs-comment">// 判断图片在不在首屏</span>
                    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.clientHeight &lt; offset.top) {
                        <span class="hljs-keyword">continue</span>;
                    }
                    <span class="hljs-comment">// 图片还没有加载完成的话</span>
                    <span class="hljs-keyword">if</span> (!img.complete) {
                        inScreenLen++;
                        img.addEventListener(<span class="hljs-string">'load'</span>, imageBack, !<span class="hljs-number">1</span>);
                    }
                }
                <span class="hljs-comment">// 如果首屏没有图片的话，直接发送日志</span>
                <span class="hljs-keyword">if</span> (inScreenLen === <span class="hljs-number">0</span>) {
                    log();
                }
                <span class="hljs-comment">// 发送日志进行统计</span>
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span> (<span class="hljs-params"></span>) </span>{
                    <span class="hljs-built_in">window</span>.logInfo.firstScreen = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'首屏时间：'</span>, <span class="hljs-built_in">window</span>.logInfo.firstScreen + <span class="hljs-string">'ms'</span>);
                }
            })();
        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>以上封装的首屏时间函数，无依赖比较小巧，同学们可以直接使用于自己的项目中。这样，我们就轻轻松松的统计到了首屏时间。</p>
<h3 id="articleHeader8">2.2 如何统计白屏时间</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;可以在页面的head底部添加的JS代码来统计白屏时间，虽然这样做可能并不十分精准，但是也可以基本代表了首屏时间，如图2.2.1所示。</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="<!DOCTYPE html>
<html>
    <head>
        <meta charset=&quot;utf-8&quot;>
        <meta name=&quot;viewport&quot; content=&quot;width=device-width,minimum-scale=1.0,maximum-scale=1.0&quot;>
        <script type=&quot;text/javascript&quot;>
            window.logInfo = {};
            window.logInfo.openTime = performance.timing.navigationStart;
            window.logInfo.whiteScreenTime = +new Date() - window.logInfo.openTime;
            console.log('白屏时间：', window.logInfo.whiteScreenTime + 'ms');
        </script>
    </head>
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs dust"><code><span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,minimum-scale=1.0,maximum-scale=1.0"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
            <span class="hljs-built_in">window</span>.logInfo = </span></span><span class="hljs-template-variable">{}</span><span class="xml"><span class="javascript">;
            <span class="hljs-built_in">window</span>.logInfo.openTime = performance.timing.navigationStart;
            <span class="hljs-built_in">window</span>.logInfo.whiteScreenTime = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'白屏时间：'</span>, <span class="hljs-built_in">window</span>.logInfo.whiteScreenTime + <span class="hljs-string">'ms'</span>);
        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
</span></code></pre>
<p><span class="img-wrap"><img data-src="/img/bVyM90" src="https://static.alili.tech/img/bVyM90" alt="155950_iY5p_1177792.png" title="155950_iY5p_1177792.png" style="cursor: pointer; display: inline;"></span><br>图2.2.1</p>
<h3 id="articleHeader9">2.3 如何统计用户可操作时间</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;前面提到过document.ready其实就可以算作我们的用户可操作时间啦。我们不妨直接试试，如图2.3.1所示：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="document
.addEventListener(
    'DOMContentLoaded',
    function (event) {
        window.logInfo.readyTime = +new Date() - window.logInfo.openTime;
        console.log('用户可操作时间：', window.logInfo.readyTime);
    }
);
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs javascript"><code><span class="hljs-built_in">document</span>
.addEventListener(
    <span class="hljs-string">'DOMContentLoaded'</span>,
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
        <span class="hljs-built_in">window</span>.logInfo.readyTime = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'用户可操作时间：'</span>, <span class="hljs-built_in">window</span>.logInfo.readyTime);
    }
);
</code></pre>
<p><span class="img-wrap"><img data-src="/img/bVyNab" src="https://static.alili.tech/img/bVyNab" alt="161009_jIOl_1177792.png" title="161009_jIOl_1177792.png" style="cursor: pointer; display: inline;"></span><br>图2.3.1</p>
<h3 id="articleHeader10">2.4 如何打印总下载时间</h3>
<p>&nbsp;&nbsp;&nbsp;&nbsp;页面总体下载时间，使用<code>window.onload</code>即可，这可以帮助我们看看我们所有的资源是否拖慢网页，如图2.4.1所示：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="window.onload = function () {
    window.logInfo.allloadTime = +new Date() - window.logInfo.openTime;
    console.log('总下载时间：', window.logInfo.allloadTime + 'ms');
};
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs javascript"><code><span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">window</span>.logInfo.allloadTime = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'总下载时间：'</span>, <span class="hljs-built_in">window</span>.logInfo.allloadTime + <span class="hljs-string">'ms'</span>);
};
</code></pre>
<p><span class="img-wrap"><img data-src="/img/bVyNaw" src="https://static.alili.tech/img/bVyNaw" alt="图片描述" title="图片描述" style="cursor: pointer;"></span><br>图2.4.1</p>
<h3 id="articleHeader11">2.5 统一打印时间，更方便</h3>
<p>&nbsp; &nbsp; 我们将上述的统计合并，一个完整的统计就出来了，如图2.5.1所示：</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="<!DOCTYPE html>
<html>
    <head>
        <meta charset=&quot;utf-8&quot;>
        <meta name=&quot;viewport&quot; content=&quot;width=device-width,minimum-scale=1.0,maximum-scale=1.0&quot;>
        <script type=&quot;text/javascript&quot;>
            window.logInfo = {};
            window.logInfo.openTime = performance.timing.navigationStart;
            window.logInfo.whiteScreenTime = +new Date() - window.logInfo.openTime;
        </script>
    </head>
    <body>
        <div>这是第一屏，这是第一屏</div>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <div>第一屏结尾，第一屏结尾</div>
        <script type=&quot;text/javascript&quot;>
            (function logFirstScreen() {
                var images = document.getElementsByTagName('img');
                var iLen = images.length;
                var curMax = 0;
                var inScreenLen = 0;
                // 图片的加载回调
                function imageBack() {
                    this.removeEventListener
                    &amp;&amp; this.removeEventListener('load', imageBack, !1);
                    if (++curMax === inScreenLen) {
                        // 如果所有在首屏的图片均已加载完成了的话，发送日志
                        log();
                    }
                }   
                // 对于所有的位于指定区域的图片，绑定回调事件
                for (var s = 0; s < iLen; s++) {
                    var img = images[s];
                    var offset = {
                        top: 0
                    };
                    var curImg = img;
                    while (curImg.offsetParent) {
                        offset.top += curImg.offsetTop;
                        curImg = curImg.offsetParent;
                    }
                    // 判断图片在不在首屏
                    if (document.documentElement.clientHeight < offset.top) {
                        continue;
                    }
                    // 图片还没有加载完成的话
                    if (!img.complete) {
                        inScreenLen++;
                        img.addEventListener('load', imageBack, !1);
                    }
                }
                // 如果首屏没有图片的话，直接发送日志
                if (inScreenLen === 0) {
                    log();
                }
                // 发送日志进行统计
                function log () {
                    window.logInfo.firstScreen = +new Date() - window.logInfo.openTime;
                }
            })();
            document
            .addEventListener(
                'DOMContentLoaded',
                function (event) {
                    window.logInfo.readyTime = +new Date() - window.logInfo.openTime;
                }
            );
            window.onload = function () {
                window.logInfo.allloadTime = +new Date() - window.logInfo.openTime;
                var timname = {
                    whiteScreenTime: '白屏时间',
                    firstScreen: '首屏时间',
                    readyTime: '用户可操作时间',
                    allloadTime: '总下载时间'
                };
                for (var i in timname) {
                    console.log(timname[i] + ':' + window.logInfo[i] + 'ms');
                }
            };
        </script>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
        <img src=&quot;http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png&quot;>
    </body>
</html>
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs xml"><code><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,minimum-scale=1.0,maximum-scale=1.0"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
            <span class="hljs-built_in">window</span>.logInfo = {};
            <span class="hljs-built_in">window</span>.logInfo.openTime = performance.timing.navigationStart;
            <span class="hljs-built_in">window</span>.logInfo.whiteScreenTime = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>这是第一屏，这是第一屏<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>第一屏结尾，第一屏结尾<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
            (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logFirstScreen</span>(<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">var</span> images = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'img'</span>);
                <span class="hljs-keyword">var</span> iLen = images.length;
                <span class="hljs-keyword">var</span> curMax = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">var</span> inScreenLen = <span class="hljs-number">0</span>;
                <span class="hljs-comment">// 图片的加载回调</span>
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">imageBack</span>(<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">this</span>.removeEventListener
                    &amp;&amp; <span class="hljs-keyword">this</span>.removeEventListener(<span class="hljs-string">'load'</span>, imageBack, !<span class="hljs-number">1</span>);
                    <span class="hljs-keyword">if</span> (++curMax === inScreenLen) {
                        <span class="hljs-comment">// 如果所有在首屏的图片均已加载完成了的话，发送日志</span>
                        log();
                    }
                }   
                <span class="hljs-comment">// 对于所有的位于指定区域的图片，绑定回调事件</span>
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> s = <span class="hljs-number">0</span>; s &lt; iLen; s++) {
                    <span class="hljs-keyword">var</span> img = images[s];
                    <span class="hljs-keyword">var</span> offset = {
                        <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>
                    };
                    <span class="hljs-keyword">var</span> curImg = img;
                    <span class="hljs-keyword">while</span> (curImg.offsetParent) {
                        offset.top += curImg.offsetTop;
                        curImg = curImg.offsetParent;
                    }
                    <span class="hljs-comment">// 判断图片在不在首屏</span>
                    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.clientHeight &lt; offset.top) {
                        <span class="hljs-keyword">continue</span>;
                    }
                    <span class="hljs-comment">// 图片还没有加载完成的话</span>
                    <span class="hljs-keyword">if</span> (!img.complete) {
                        inScreenLen++;
                        img.addEventListener(<span class="hljs-string">'load'</span>, imageBack, !<span class="hljs-number">1</span>);
                    }
                }
                <span class="hljs-comment">// 如果首屏没有图片的话，直接发送日志</span>
                <span class="hljs-keyword">if</span> (inScreenLen === <span class="hljs-number">0</span>) {
                    log();
                }
                <span class="hljs-comment">// 发送日志进行统计</span>
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span> (<span class="hljs-params"></span>) </span>{
                    <span class="hljs-built_in">window</span>.logInfo.firstScreen = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
                }
            })();
            <span class="hljs-built_in">document</span>
            .addEventListener(
                <span class="hljs-string">'DOMContentLoaded'</span>,
                <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
                    <span class="hljs-built_in">window</span>.logInfo.readyTime = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
                }
            );
            <span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                <span class="hljs-built_in">window</span>.logInfo.allloadTime = +<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - <span class="hljs-built_in">window</span>.logInfo.openTime;
                <span class="hljs-keyword">var</span> timname = {
                    <span class="hljs-attr">whiteScreenTime</span>: <span class="hljs-string">'白屏时间'</span>,
                    <span class="hljs-attr">firstScreen</span>: <span class="hljs-string">'首屏时间'</span>,
                    <span class="hljs-attr">readyTime</span>: <span class="hljs-string">'用户可操作时间'</span>,
                    <span class="hljs-attr">allloadTime</span>: <span class="hljs-string">'总下载时间'</span>
                };
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> timname) {
                    <span class="hljs-built_in">console</span>.log(timname[i] + <span class="hljs-string">':'</span> + <span class="hljs-built_in">window</span>.logInfo[i] + <span class="hljs-string">'ms'</span>);
                }
            };
        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://static.oschina.net/uploads/space/2016/0623/152644_6UUC_1177792.png"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><span class="img-wrap"><img data-src="/img/bVyNaA" src="https://static.alili.tech/img/bVyNaA" alt="161744_kOfK_1177792.png" title="161744_kOfK_1177792.png" style="cursor: pointer;"></span><br>图2.5.1</p>
<p>按照上一节( <a href="https://segmentfault.com/a/1190000005861012">https://segmentfault.com/a/1190000005861012</a> )所说，我们将这个日志发送到服务端去。</p>
<div class="widget-codetool" style="display:none;">
      <div class="widget-codetool--inner">
      <span class="selectCode code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="全选"></span>
      <span type="button" class="copyCode code-tool" data-toggle="tooltip" data-placement="top" data-clipboard-text="var logStr = '';
for (var i in timname) {
    logStr += '&amp;' + i + '=' + window.logInfo[i];
}
(new Image()).src = 'http://localhost:8091/?action=speedlog' + logStr;
" title="" data-original-title="复制"></span>
      <span type="button" class="saveToNote code-tool" data-toggle="tooltip" data-placement="top" title="" data-original-title="放进笔记"></span>
      </div>
      </div><pre class="hljs dart"><code><span class="hljs-keyword">var</span> logStr = <span class="hljs-string">''</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> timname) {
    logStr += <span class="hljs-string">'&amp;'</span> + i + <span class="hljs-string">'='</span> + <span class="hljs-built_in">window</span>.logInfo[i];
}
(<span class="hljs-keyword">new</span> Image()).src = <span class="hljs-string">'http://localhost:8091/?action=speedlog'</span> + logStr;
</code></pre>
<p>开启我们的nginx监听，并在服务端接收这条日志如图2.5.2，图2.5.3所示：</p>
<p><span class="img-wrap"><img data-src="/img/bVyNaC" src="https://static.alili.tech/img/bVyNaC" alt="162439_crrp_1177792.png" title="162439_crrp_1177792.png" style="cursor: pointer;"></span><br>图2.5.2</p>
<p><span class="img-wrap"><img data-src="/img/bVyNb2" src="https://static.alili.tech/img/bVyNb2" alt="162553_ZBUv_1177792.png" title="162553_ZBUv_1177792.png" style="cursor: pointer;"></span><br>图2.5.3</p>
<p>我们看看日志里面是不是已经多了一条了呢？</p>
<p>要是再加以定时任务，日志采集等功能的辅助，我们就能实时掌握自己网站的性能啦。</p>
<h4>不要走开，请关注我。下一章，我们将继续聊聊百度移动版首页那些事。</h4>
<p><a href="https://segmentfault.com/a/1190000005882953" target="_blank">https://segmentfault.com/a/1190000005882953</a></p>
<p>后续，我们也会一起来聊聊，如何优化我们的这些速度，以提高我们的网站性能。</p>
<p>原创文章,版权所有,转载请注明出处</p>

                
{{< /raw >}}

# 版权声明
本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，

本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。

原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！

## 原文标题
[聊一聊系列]聊一聊前端速度统计(性能统计)那些事儿

## 原文链接
[https://segmentfault.com/a/1190000005869953](https://segmentfault.com/a/1190000005869953)

